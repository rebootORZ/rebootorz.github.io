<!DOCTYPE html>
<html lang="zh-Hans">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Burpsuit插件开发 | rebootORZ Security</title>

    
<link href="favicon.ico" rel="shortcut icon" type="image/x-icon" />




<meta name="author" content="rebootORZ" />
<meta name="description" content="前言 官方API文档：https://portswigger.net/burp/extender/api/index.html Ps:也可以直接" />



<meta name="generator" content="Hugo 0.101.0" />

<link rel="canonical" href="https://rebootorz.github.io/posts/burpsuit%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/" />


<meta property="og:title" content="Burpsuit插件开发" />
<meta property="og:description" content="前言 官方API文档：https://portswigger.net/burp/extender/api/index.html Ps:也可以直接" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://rebootorz.github.io/posts/burpsuit%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/" /><meta property="og:image" content="https://rebootorz.github.io/me/background.jpg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-05T16:07:29+08:00" />
<meta property="article:modified_time" content="2022-07-05T16:07:29+08:00" />




<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://rebootorz.github.io/me/background.jpg"/>

<meta name="twitter:title" content="Burpsuit插件开发"/>
<meta name="twitter:description" content="前言 官方API文档：https://portswigger.net/burp/extender/api/index.html Ps:也可以直接"/>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" integrity="sha256-UXesixbeLkB/UYxVTzuj/gg3+LMzgwAmg3zD+C4ZASQ=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/icomoon.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/overlayscrollbars@1.13.1/css/OverlayScrollbars.min.css" integrity="sha256-WKijf8KI68sbq8Znd6yMepIuFF0wdWfIt6gk3JWcQfk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css">
<link rel="stylesheet" href="/css/site.css" />

<style>
  .ui.header a:not(.item, .ui.button):hover {
    text-decoration: underline;
  }

  
  a:not(.item, .ui.button) {
    color: seagreen !important;
  }
  

  
  .inverted a:not(.item, .ui.button) {
     color: darkseagreen !important;
  }
  

  
  body.default {
    
    background-color: #fff;
    

    
    background-image: url(/me/black_background.jpg);
    
  }
  

  
  body.dark {
    

    
    background-image: url(/me/light_background.jpeg);
    
  }
  
</style>


    







    
    <link rel="stylesheet" href="/css/custom.css" />
    
  </head>

  <body class="default">
    
<nav class="ui secondary menu dream-menu dream-nav">

  <a class="item dream-flip-toggle" title="翻转！">
    <i class="large link bullseye icon"></i>
  </a>
  <a class="item" href="https://rebootorz.github.io" title="首页">
    <i class="large link home icon"></i>
  </a>
  
  <a class="item" onclick="themeSwitch(event)">
    <i class="large link icon theme-switch"></i>
  </a>
  
  
  <a class="item" title="搜索" onclick="toggleSearch(event)">
    <i class="large link search icon"></i>
  </a>
  
</nav>

    <div class="flip-container">
      <div class="flipper">
        <section class="front">
          <div class="dream-max-width">
            
<div class="ui relaxed centered grid dream-grid dream-grid-single">
  
  
  
  

  
  <aside class="sixteen wide mobile sixteen wide tablet three wide computer column dream-single-aside">
    
    <div class="ui segment toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#前言">前言</a></li>
    <li><a href="#开发环境">开发环境</a></li>
    <li><a href="#准备工作">准备工作</a></li>
    <li><a href="#相关接口">相关接口</a>
      <ul>
        <li><a href="#iburpextender">IBurpExtender</a></li>
        <li><a href="#iburpextendercallbacks">IBurpExtenderCallbacks</a></li>
        <li><a href="#icontextmenufactory">IContextMenuFactory</a></li>
        <li><a href="#icontextmenuinvocation">IContextMenuInvocation</a></li>
        <li><a href="#icookie">ICookie</a></li>
        <li><a href="#iextensionhelpers">IExtensionHelpers</a></li>
        <li><a href="#iextensionstatelistener">IExtensionStateListener</a></li>
        <li><a href="#ihttplistener">IHttpListener</a></li>
        <li><a href="#ihttprequestresponse">IHttpRequestResponse</a></li>
        <li><a href="#ihttprequestresponsewithmarkers">IHttpRequestResponseWithMarkers</a></li>
        <li><a href="#ihttpservice">IHttpService</a></li>
        <li><a href="#iintruderattack">IIntruderAttack</a></li>
        <li><a href="#iinterceptedproxymessage">IInterceptedProxyMessage</a></li>
        <li><a href="#iintruderpayloadgenerator">IIntruderPayloadGenerator</a></li>
        <li><a href="#iintruderpayloadgeneratorfactory">IIntruderPayloadGeneratorFactory</a></li>
        <li><a href="#iintruderpayloadprocessor">IIntruderPayloadProcessor</a></li>
        <li><a href="#imessageeditor">IMessageEditor</a></li>
        <li><a href="#imessageeditortab">IMessageEditorTab</a></li>
        <li><a href="#imessageeditorcontroller">IMessageEditorController</a></li>
        <li><a href="#imessageeditortabfactory">IMessageEditorTabFactory</a></li>
        <li><a href="#iparameter">IParameter</a></li>
        <li><a href="#iproxylistener">IProxyListener</a></li>
        <li><a href="#irequestinfo">IRequestInfo</a></li>
        <li><a href="#iresponseinfo">IResponseInfo</a></li>
        <li><a href="#iscanissue">IScanIssue</a></li>
        <li><a href="#iscannercheck">IScannerCheck</a></li>
        <li><a href="#iscannerinsertionpoint">IScannerInsertionPoint</a></li>
        <li><a href="#iscannerinsertionpointprovider">IScannerInsertionPointProvider</a></li>
        <li><a href="#iscannerlistener">IScannerListener</a></li>
        <li><a href="#iscanqueueitem">IScanQueueItem</a></li>
        <li><a href="#iscopechangelistener">IScopeChangeListener</a></li>
        <li><a href="#isessionhandlingaction">ISessionHandlingAction</a></li>
        <li><a href="#itab">ITab</a></li>
        <li><a href="#itempfile">ITempFile</a></li>
        <li><a href="#itexteditor">ITextEditor</a></li>
      </ul>
    </li>
    <li><a href="#java-swing">Java Swing</a>
      <ul>
        <li><a href="#常用控件">常用控件</a></li>
      </ul>
    </li>
    <li><a href="#开发实践">开发实践</a>
      <ul>
        <li><a href="#解决问题">解决问题</a></li>
        <li><a href="#实现思路">实现思路</a></li>
        <li><a href="#核心代码">核心代码</a></li>
        <li><a href="#最后效果">最后效果</a></li>
      </ul>
    </li>
    <li><a href="#总结">总结</a></li>
  </ul>
</nav>
    </div>
    

    
  </aside>
  
  <div class="sixteen wide mobile sixteen wide tablet ten wide computer column markdown-body dream-single" id="dream-save-post-as-img">
    <section class="ui segment">
      <header>
        <h1 class="ui large header">Burpsuit插件开发<span class="sub header">
            <span class="left">
              @
              
                
                  rebootORZ
                
              

              | 
                  <span data-format="luxon">2022-07-05T16:07:29&#43;08:00</span>
                

              | 33 分钟阅读

              
              | 更新于
                
                  <span data-format="luxon">2022-07-05T16:07:29&#43;08:00</span>
                
              
            </span>

            
            <span class="dream-share">
  <a href="#" class="save-as-image" title="保存为图片" onclick="savePostAsImg()">
    <i class="save icon"></i>
  </a>
  <a href="https://twitter.com/intent/tweet?text=Burpsuit%e6%8f%92%e4%bb%b6%e5%bc%80%e5%8f%91&url=https%3a%2f%2frebootorz.github.io%2fposts%2fburpsuit%25E6%258F%2592%25E4%25BB%25B6%25E5%25BC%2580%25E5%258F%2591%2f" title="Twitter">
    <i class="twitter icon"></i>
  </a>
  <a href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2frebootorz.github.io%2fposts%2fburpsuit%25E6%258F%2592%25E4%25BB%25B6%25E5%25BC%2580%25E5%258F%2591%2f" title="Facebook">
    <i class="facebook icon"></i>
  </a>
</span>

            
          </span>
        </h1>
      </header>

      <article class="main">
        

        <h2 id="前言">前言</h2>
<p>官方API文档：https://portswigger.net/burp/extender/api/index.html</p>
<pre><code>Ps:也可以直接看burp suit-Extender-APIs功能下的API说明
</code></pre>
<p>官方的文档对于开发能力很一般的人来说可能不一定马上就能上手，所以建议找一些国人写的文档来看，方便理解。这里推荐以前乌云上的大佬写的文章进行学习，这里只找到内容，但是找不到原出处了：</p>
<ul>
<li>
<p><a href="https://blog.csdn.net/zhangmiaoping23/article/details/79786187">《BurpSuite插件开发指南之 Java 上篇》 </a></p>
</li>
<li>
<p><a href="https://blog.csdn.net/zhangmiaoping23/article/details/79786631?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-1.control&amp;spm=1001.2101.3001.4242">《BurpSuite插件开发指南之 Java 下篇》</a></p>
</li>
<li>
<p><a href="https://blog.csdn.net/zhangmiaoping23/article/details/79787139">《BurpSuite插件开发指南之 API 篇》</a></p>
</li>
</ul>
<p>具体开发的时候建议先看这篇文章，会很有启发：</p>
<p><a href="https://www.secpulse.com/archives/124593.html">从头开发一个BurpSuite数据收集插件</a></p>
<p>本文主要是记录学习的过程，文中的代码片段和概念会有些是从上文中摘抄过来，开发能力较弱，有些写的不好的地方各位可以改改- -。</p>
<h2 id="开发环境">开发环境</h2>
<p>编辑器 IDEAJ 2021.1</p>
<p>电脑 Macbook 2019 pro</p>
<p>JDK 版本1.8.0_261</p>
<p>BurpSuit Professional v2.1.06</p>
<h2 id="准备工作">准备工作</h2>
<p>项目中需要导入官方的SDK包，但是根据网上的说法，官方目前已经不提供SDK包了，我们可以自行从burpsuit中直接导出(需要选择一个空白目录)：</p>
<p><img src="/imgs/image-20210820145940973.png" alt="image-20210820145940973"></p>
<p>导出后会有一个burp文件夹，结构如下：</p>
<p>这些就是官方提供的所有接口了</p>
<img src="/imgs/image-20210820150221565.png" alt="image-20210820150221565" style="zoom:50%;" />
<p>接下来，创建一个空白项目：</p>
<img src="/imgs/image-20210820150453664.png" alt="image-20210820150453664" style="zoom:50%;" />
<p>然后在src目录下创建一个名为&quot;burp&quot;的package，并将前面下载下来的所有文件拷贝进去：</p>
<p><img src="/imgs/image-20210820150716577.png" alt="image-20210820150716577"></p>
<p>至此开发前期的准备工作已完成。</p>
<h2 id="相关接口">相关接口</h2>
<h3 id="iburpextender">IBurpExtender</h3>
<p>​	这个接口是官方规定的，在进行插件开发时必须要实现的一个接口，且实现的类的类名必须叫“BurpExtender.java”并声明为public，在这个类中，必须提供一个默认的构造方法，该类需要放在burp包中，如下：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// TODO here
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/imgs/image-20210820160105828.png" alt="image-20210820160105828"></p>
<h3 id="iburpextendercallbacks">IBurpExtenderCallbacks</h3>
<p>上面我们提到了，有一个默认的构造方法，即“registerExtenderCallbacks(final IBurpExtenderCallbacks callbacks)”，该方法在插件被burpsuit加载后会被调用，这里它我们提供了一个IBurpExtenderCallbacks接口的实例，而这个接口提供了很多有用的方法。我们可以跟进这个方法看一下：</p>
<p>可以看到例如：输入输出、对其他模块的调用等，这里面都有提供。</p>
<p><img src="/imgs/image-20210820160137456.png" alt="image-20210820160137456"></p>
<p><img src="/imgs/image-20210820160206227.png" alt="image-20210820160206227"></p>
<p>​	通过这个实例“callbacks”我们可以进行一系列操作，例如：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setExtensionName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span> <span style="color:#6272a4">//设置扩展名称为 “rebootORZ”
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>打包成jar包：</p>
<ul>
<li>File - Project Structure - Project Settings - Artifacts - “+” - JAR - From modules with dependencies - 在Main Class中输入&quot;BurpExtender&quot; - OK</li>
</ul>
<img src="/imgs/image-20210820154015877.png" alt="image-20210820154015877" style="zoom:50%;" />
<img src="/imgs/image-20210820154039674.png" alt="image-20210820154039674" style="zoom:50%;" />
<ul>
<li>
<p>Build - Build Project</p>
</li>
<li>
<p>Build - Build Artifacts</p>
</li>
<li>
<p>Build</p>
<img src="/imgs/image-20210820154303900.png" alt="image-20210820154303900" style="zoom:50%;" />
<p>输出默认路径：out/artifacts/burpExterder_jar/burpExterder.jar</p>
<p>导入burpsuit效果如下：</p>
<p><img src="/imgs/image-20210820160532555.png" alt="image-20210820160532555"></p>
</li>
</ul>
<h3 id="icontextmenufactory">IContextMenuFactory</h3>
<p>根据官方API文档的说明：</p>
<p>“Extensions can implement this interface and then call <code>IBurpExtenderCallbacks.registerContextMenuFactory()</code> to register a factory for custom context menu items.”</p>
<p>“通过扩展实现该接口，然后调用 IBurpExtenderCallbacks.registerContextMenuFactory() 为自定义上下文菜单项注册工厂。”</p>
<p>​		简而言之，这里使用了工厂模式，我们需要先通过registerContextMenuFactory()注册一个工厂，然后通过实现IContextMenuFactory接口里面的createMenuItems()方法，就可以进行菜单的创建了。关于该接口的官方说明如下：</p>
<p>“This method will be called by Burp when the user invokes a context menu anywhere within Burp. The factory can then provide any custom context menu items that should be displayed in the context menu, based on the details of the menu invocation.”</p>
<p>“当用户在 Burp 内的任何位置调用上下文菜单时，该方法将被 Burp 调用。然后，工厂可以根据菜单调用的详细信息，提供应该在上下文菜单中显示的任何自定义上下文菜单项。”</p>
<p>也就是说，</p>
<p>要使用该接口需要先调用registerContextMenuFactory()注册一个上下文菜单项，然后才可以通过实现IContextMenuFactory接口去创建菜单，例如：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> javax.swing.*<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.util.ArrayList<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.util.List<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">,</span>IContextMenuFactory<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setExtensionName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span> <span style="color:#6272a4">//设置扩展名称为 “rebootORZ”
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">registerContextMenuFactory</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> List<span style="color:#ff79c6">&lt;</span>JMenuItem<span style="color:#ff79c6">&gt;</span> <span style="color:#50fa7b">createMenuItems</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IContextMenuInvocation invocation<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        List<span style="color:#ff79c6">&lt;</span>JMenuItem<span style="color:#ff79c6">&gt;</span> listMenuItems <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> ArrayList<span style="color:#ff79c6">&lt;</span>JMenuItem<span style="color:#ff79c6">&gt;();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//子菜单
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        JMenuItem menuItem<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>        menuItem <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JMenuItem<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;子菜单测试&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//父级菜单
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        JMenu jMenu <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JMenu<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        jMenu<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>menuItem<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        listMenuItems<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>jMenu<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> listMenuItems<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/imgs/image-20210820162626199.png" alt="image-20210820162626199"></p>
<h3 id="icontextmenuinvocation">IContextMenuInvocation</h3>
<p>该接口的作用，官方的说法和网上的文章说的比较拗口，其实就是调用菜单的时候，用来获取一些相关信息，例如用来判断当前是在哪个功能里面进行调用的，是在&quot;Intruder&quot;还是&quot;Repeater&quot;等。</p>
<p>其中提供了以下方法：</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>java.awt.event.InputEvent</td>
<td>getInputEvent()<br />这个方法可以用来检索触发上下文菜单的本地Java输入事件。</td>
</tr>
<tr>
<td>byte</td>
<td>getInvocationContext()<br />这个方法可以用来检索调用该菜单的上下文。</td>
</tr>
<tr>
<td>IScanIssue[]</td>
<td>getSelectedIssues()<br />此方法可用于检索用户在调用上下文菜单时选择的扫描器问题的详细信息。</td>
</tr>
<tr>
<td>IHttpRequestResponse[]</td>
<td>getSelectedMessages()<br />此方法可用于检索在调用上下文菜单时用户显示或选择的 HTTP 请求/响应的详细信息。</td>
</tr>
<tr>
<td>int[]</td>
<td>getSelectionBounds()<br />此方法被用于获取用户所选的当前消息的界限（消息需可适用）</td>
</tr>
<tr>
<td>int</td>
<td>getToolFlag()<br />此方法被用于获取调用上下文菜单的 Burp 工具</td>
</tr>
</tbody>
</table>
<p>例如，设置改上下文菜单只允许在Repeater模块中显示，代码如下：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> javax.swing.*<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.util.ArrayList<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.util.List<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">,</span>IContextMenuFactory<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setExtensionName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span> <span style="color:#6272a4">//设置扩展名称为 “rebootORZ”
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">registerContextMenuFactory</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> List<span style="color:#ff79c6">&lt;</span>JMenuItem<span style="color:#ff79c6">&gt;</span> <span style="color:#50fa7b">createMenuItems</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IContextMenuInvocation invocation<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        List<span style="color:#ff79c6">&lt;</span>JMenuItem<span style="color:#ff79c6">&gt;</span> listMenuItems <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> ArrayList<span style="color:#ff79c6">&lt;</span>JMenuItem<span style="color:#ff79c6">&gt;();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>				<span style="color:#6272a4">//判断是否是Repeater模块
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">if</span><span style="color:#ff79c6">(</span>invocation<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getToolFlag</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">==</span> IBurpExtenderCallbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">TOOL_REPEATER</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#6272a4">//子菜单
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>            JMenuItem menuItem<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>            menuItem <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JMenuItem<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;子菜单测试&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#6272a4">//父级菜单
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>            JMenu jMenu <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JMenu<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>            jMenu<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>menuItem<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>            listMenuItems<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>jMenu<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> listMenuItems<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>此时在其他模块中不会有该菜单：</p>
<p><img src="/imgs/image-20210822141025130.png" alt="image-20210822141025130"></p>
<p>当在Repeater中就有了：</p>
<img src="/imgs/image-20210822141103371.png" alt="image-20210822141103371" style="zoom: 50%;" />
<h3 id="icookie">ICookie</h3>
<p>这个接口用于获取 cookie 相关的信息，提供了以下方法：</p>
<table>
<thead>
<tr>
<th>修饰符与类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>java.lang.String</td>
<td>getDomain()<br />用于获取 Cookie 的域</td>
</tr>
<tr>
<td>java.util.Date</td>
<td>getExpiration()<br />用于获取 Cookie 的过期时间</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getName()<br />用于获取 Cookie 的名称</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getPath()<br />用于获取 Cookie 的路径</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getValue()<br />用于获取 Cookie 的值</td>
</tr>
</tbody>
</table>
<p>示例代码：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.io.PrintWriter<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.util.List<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">,</span> IHttpListener<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> PrintWriter stdout<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> IExtensionHelpers helpers<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> IRequestInfo iRequestInfo<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> List<span style="color:#ff79c6">&lt;</span>ICookie<span style="color:#ff79c6">&gt;</span> cookieList<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> String cookie<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setExtensionName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">registerHttpListener</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        helpers <span style="color:#ff79c6">=</span> callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getHelpers</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        cookieList <span style="color:#ff79c6">=</span> callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getCookieJarContents</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//设置输入输出流
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">stdout</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> PrintWriter<span style="color:#ff79c6">(</span>callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getStdout</span><span style="color:#ff79c6">(),</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">GetCookie</span><span style="color:#ff79c6">(</span>IHttpRequestResponse messageInfo<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> 0<span style="color:#ff79c6">;</span> i<span style="color:#ff79c6">&lt;</span>cookieList<span style="color:#ff79c6">.</span><span style="color:#50fa7b">size</span><span style="color:#ff79c6">();</span>i<span style="color:#ff79c6">++){</span>
</span></span><span style="display:flex;"><span>            String cookieName<span style="color:#ff79c6">=</span>cookieList<span style="color:#ff79c6">.</span><span style="color:#50fa7b">get</span><span style="color:#ff79c6">(</span>i<span style="color:#ff79c6">).</span><span style="color:#50fa7b">getName</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>            String cookieValue<span style="color:#ff79c6">=</span>cookieList<span style="color:#ff79c6">.</span><span style="color:#50fa7b">get</span><span style="color:#ff79c6">(</span>i<span style="color:#ff79c6">).</span><span style="color:#50fa7b">getValue</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">if</span><span style="color:#ff79c6">(</span>i<span style="color:#ff79c6">==</span>0<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>                cookie <span style="color:#ff79c6">=</span> cookieName<span style="color:#ff79c6">+</span><span style="color:#f1fa8c">&#34;=&#34;</span><span style="color:#ff79c6">+</span>cookieValue<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span><span style="color:#ff79c6">else</span><span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                cookie <span style="color:#ff79c6">=</span> cookie<span style="color:#ff79c6">+</span><span style="color:#f1fa8c">&#34;&amp;&#34;</span><span style="color:#ff79c6">+</span>cookieName<span style="color:#ff79c6">+</span><span style="color:#f1fa8c">&#34;=&#34;</span><span style="color:#ff79c6">+</span>cookieValue<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>        stdout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span>cookie<span style="color:#ff79c6">+</span><span style="color:#f1fa8c">&#34;\n&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">processHttpMessage</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd">int</span> toolFlag<span style="color:#ff79c6">,</span> <span style="color:#8be9fd">boolean</span> messageIsRequest<span style="color:#ff79c6">,</span> IHttpRequestResponse messageInfo<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">if</span><span style="color:#ff79c6">(</span>messageIsRequest<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">GetCookie</span><span style="color:#ff79c6">(</span>messageInfo<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="iextensionhelpers">IExtensionHelpers</h3>
<p>这个接口提供了很多常用的辅助方法，可以通过调用 IBurpExtenderCallbacks.getHelpers获得此接口的实例。</p>
<p>这个接口提供的方法有非常多，对于我们编写插件比较常用的有以下：</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>byte[]</td>
<td>addParameter(byte[] request, IParameter parameter)<br />添加http请求参数并更新 Content-Length</td>
</tr>
<tr>
<td>IRequestInfo</td>
<td>analyzeRequest(byte[] request)<br />解析http请求并获取键值对</td>
</tr>
<tr>
<td>IResponseInfo</td>
<td>analyzeResponse(byte[] response)<br />解析http响应并获取键值对</td>
</tr>
<tr>
<td>byte[]</td>
<td>buildHttpMessage(java.util.List&lt;java.lang.String&gt; headers, byte[] body)<br />根据提供的请求头和请求体拼接数据包</td>
</tr>
<tr>
<td>byte[]</td>
<td>buildHttpRequest(java.net.URL url)<br />对给定的 URL 发起 GET 请求</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>bytesToString(byte[] data)<br />bytes 到 String 的转换</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>bytesToString(byte[] data)<br />String 到 bytes 的转</td>
</tr>
</tbody>
</table>
<h3 id="iextensionstatelistener">IExtensionStateListener</h3>
<p>​		这个接口在使用前需要先调用IBurpExtenderCallbacks.registerExtensionStateListener() 注册一个扩展的状态监听器，当扩展的状态发生改变时，监听器会收到通知并触发操作，相当于是在做善后的处理。</p>
<p>​		这个接口只提供了一个卸载的方法，当然用户从burpsuit unload这个插件的时候就会调用该方法并执行一些操作，具体操作的内容我们可以通过重写这个方法来实现。</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.io.PrintWriter<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">,</span> IExtensionStateListener<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> PrintWriter stdout<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">stdout</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> PrintWriter<span style="color:#ff79c6">(</span>callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getStdout</span><span style="color:#ff79c6">(),</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setExtensionName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 先注册扩展状态监听器
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">registerExtensionStateListener</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// 重写 extensionUnloaded 方法
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">extensionUnloaded</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// TODO
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">stdout</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;unload success ...&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/imgs/image-20210822145518672.png" alt="image-20210822145518672"></p>
<h3 id="ihttplistener">IHttpListener</h3>
<p>使用该接口前，需要先通过 IBurpExtenderCallbacks.registerHttpListener() 注册一个 HTTP 监听器，这样所有的HTTP请求和响应都会通知这个监听器，就可以在这个监听器对HTTP数据包进行分析或修改了。</p>
<p>该接口只提供了一个方法：</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>void</td>
<td>processHttpMessage(int toolFlag, boolean messageIsRequest, IHttpRequestResponse messageInfo)<br />当一个HTTP请求即将发出时，以及当收到一个HTTP响应时，这个方法被调用。</td>
</tr>
</tbody>
</table>
<p>参数说明：</p>
<ul>
<li>
<p>toolFlag 指的就是当前在哪个模块，可以根据模块筛选自己要的数据包，这个模块所对应的一个标志符，这个符号的定义在IBurpExtenderCallbacks接口中：</p>
<img src="/imgs/image-20210822152136660.png" alt="image-20210822152136660" style="zoom:50%;" />
</li>
<li>
<p>messageIsRequest  用来判断该数据包是请求包（True）还是响应包（False）</p>
</li>
<li>
<p>messageInfo  该数据包的详细信息，是一个 IHttpRequestResponse 对象</p>
</li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">,</span> IHttpListener<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setExtensionName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">registerHttpListener</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">processHttpMessage</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd">int</span> toolFlag<span style="color:#ff79c6">,</span> <span style="color:#8be9fd">boolean</span> messageIsRequest<span style="color:#ff79c6">,</span> IHttpRequestResponse messageInfo<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// TODO here
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ihttprequestresponse">IHttpRequestResponse</h3>
<p>这个接口用于获取/修改请求/响应的信息。</p>
<p>提供的方法中，所有的set方法只能在消息被发送出去之前进行处理，但是在只读的上下文里面是不可以用的，因为set是写操作，而与响应有关的get方法也只能在请求发出后使用。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>java.lang.String</td>
<td>getComment()<br />获取用户标注的注释信息</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getHighlight()<br />获取用户标注的高亮信息</td>
</tr>
<tr>
<td>IHttpService</td>
<td>getHttpService()<br />获取请求/响应的 HTTP 服务信息</td>
</tr>
<tr>
<td>byte[]</td>
<td>getRequest()<br />获取 HTTP 请求信息</td>
</tr>
<tr>
<td>byte[]</td>
<td>getResponse()<br />获取 HTTP 响应信息</td>
</tr>
<tr>
<td>void</td>
<td>setComment(java.lang.String comment)<br />更新用户标注的注释信息</td>
</tr>
<tr>
<td>void</td>
<td>setHighlight(java.lang.String color)<br />更新用户标注的高亮信息</td>
</tr>
<tr>
<td>void</td>
<td>setHttpService(IHttpService httpService)<br />更新 请求/响应的 HTTP 服务信息</td>
</tr>
<tr>
<td>void</td>
<td>setRequest(byte[] message)<br />更新 HTTP 请求信息</td>
</tr>
<tr>
<td>void</td>
<td>setResponse(byte[] message)<br />更新 HTTP 响应信息</td>
</tr>
</tbody>
</table>
<p>示例代码：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.io.PrintWriter<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.util.Arrays<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.util.List<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">,</span> IHttpListener<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> PrintWriter stdout<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> IExtensionHelpers helpers<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> IBurpExtenderCallbacks burpCallback<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setExtensionName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">registerHttpListener</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        helpers <span style="color:#ff79c6">=</span> callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getHelpers</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//设置输入输出流
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">stdout</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> PrintWriter<span style="color:#ff79c6">(</span>callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getStdout</span><span style="color:#ff79c6">(),</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">runRequest</span><span style="color:#ff79c6">(</span>IHttpRequestResponse req<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">try</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> rawRequest <span style="color:#ff79c6">=</span> req<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getRequest</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            IRequestInfo reqInfo <span style="color:#ff79c6">=</span> helpers<span style="color:#ff79c6">.</span><span style="color:#50fa7b">analyzeRequest</span><span style="color:#ff79c6">(</span>rawRequest<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#6272a4">// header of request should be a string
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>            List<span style="color:#ff79c6">&lt;</span>String<span style="color:#ff79c6">&gt;</span> headers <span style="color:#ff79c6">=</span> reqInfo<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getHeaders</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">for</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd">int</span> h<span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">;</span> h<span style="color:#ff79c6">&lt;</span>headers<span style="color:#ff79c6">.</span><span style="color:#50fa7b">size</span><span style="color:#ff79c6">();</span> h<span style="color:#ff79c6">++){</span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">//打印请求包
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                stdout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span>headers<span style="color:#ff79c6">.</span><span style="color:#50fa7b">get</span><span style="color:#ff79c6">(</span>h<span style="color:#ff79c6">)+</span><span style="color:#f1fa8c">&#34;\n&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span> <span style="color:#ff79c6">catch</span> <span style="color:#ff79c6">(</span>Throwable e<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            PrintWriter writer <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> PrintWriter<span style="color:#ff79c6">(</span>burpCallback<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getStderr</span><span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>            writer<span style="color:#ff79c6">.</span><span style="color:#50fa7b">write</span><span style="color:#ff79c6">(</span>e<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getMessage</span><span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>            writer<span style="color:#ff79c6">.</span><span style="color:#50fa7b">write</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;\n&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>            e<span style="color:#ff79c6">.</span><span style="color:#50fa7b">printStackTrace</span><span style="color:#ff79c6">(</span>writer<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">processHttpMessage</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd">int</span> toolFlag<span style="color:#ff79c6">,</span> <span style="color:#8be9fd">boolean</span> messageIsRequest<span style="color:#ff79c6">,</span> IHttpRequestResponse messageInfo<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">if</span><span style="color:#ff79c6">(</span>messageIsRequest<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">runRequest</span><span style="color:#ff79c6">(</span>messageInfo<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ihttprequestresponsewithmarkers">IHttpRequestResponseWithMarkers</h3>
<p>​		IHttpRequestResponseWithMarkers是 IHttpRequestResponse 接口的一个子接口，用于那些已被标记的 IHttpRequestResponse 对象，可用 IBurpExtenderCallbacks.applyMarkers() 创建一个此接口的实例，标记可用于各种情况，如指定Intruder 工具的 payload 位置，Scanner 工具的插入点或将 Scanner 工具的一些问题置为高亮。</p>
<p>​		此接口提供了两个分别操作请求和响应的方法：</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>java.util.List&lt;int[]&gt;</td>
<td>getRequestMarkers()<br />获取带有标记的请求信息的详细信息</td>
</tr>
<tr>
<td>java.util.List&lt;int[]&gt;</td>
<td>getResponseMarkers()<br />获取带有标记的返回信息的详细信息</td>
</tr>
</tbody>
</table>
<p>​		这两个方法的返回值均为一个整型数组列表，分别表示请求消息/响应消息标记偏移的索引对。列表中的每一项目都是一个长度为 2 的整型数组，包含标记开始和结束的偏移量。如果没有定义请求/响应标记，返回 null。</p>
<h3 id="ihttpservice">IHttpService</h3>
<p>此接口用于提供关于 HTTP 服务信息的细节。</p>
<p>只提供了三个方法：</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>java.lang.String</td>
<td>getHost()<br />返回 HTTP 服务信息的主机名或 IP 地址</td>
</tr>
<tr>
<td>Int</td>
<td>getPort()<br />返回 HTTP 服务信息的端口</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getProtocol()<br />返回 HTTP 服务信息的协议</td>
</tr>
</tbody>
</table>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.io.PrintWriter<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">,</span> IHttpListener<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> PrintWriter stdout<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> IBurpExtenderCallbacks iCallbacks<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">stdout</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> PrintWriter<span style="color:#ff79c6">(</span>callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getStdout</span><span style="color:#ff79c6">(),</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setExtensionName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">registerHttpListener</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">processHttpMessage</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd">int</span> toolFlag<span style="color:#ff79c6">,</span> <span style="color:#8be9fd">boolean</span> messageIsRequest<span style="color:#ff79c6">,</span> IHttpRequestResponse messageInfo<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        IHttpService iHttpService <span style="color:#ff79c6">=</span> messageInfo<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getHttpService</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">stdout</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span>iHttpService<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getHost</span><span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">stdout</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span>iHttpService<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getPort</span><span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">stdout</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span>iHttpService<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getProtocol</span><span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>发送一个数据包，然后看输出：</p>
<img src="/imgs/image-20210822170202630.png" alt="image-20210822170202630" style="zoom:50%;" />
<h3 id="iintruderattack">IIntruderAttack</h3>
<p>这个接口用于保存关于爆破的详细信息。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>IHttpService</td>
<td>getHttpService()</td>
</tr>
<tr>
<td>byte[]</td>
<td>getRequestTemplate()</td>
</tr>
</tbody>
</table>
<h3 id="iinterceptedproxymessage">IInterceptedProxyMessage</h3>
<p>​		此接口不能被扩展实现，它表示了已被 Burp 代理拦截的 HTTP 消息。扩展可以利用此接口注册一个 IProxyListener 以便接收代理消息的细节。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>java.net.InetAddress</td>
<td>getClientIpAddress()<br />获取被拦截的请求消息的客户端 IP 地址</td>
</tr>
<tr>
<td>int</td>
<td>getInterceptAction()<br />获取当前定义的拦截操作类型，具体的类型可以在本接口中看到</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getListenerInterface()<br />获取 Burp Proxy 处理拦截消息监听器的名称</td>
</tr>
<tr>
<td>IHttpRequestResponse</td>
<td>getMessageInfo()<br />获取被拦截的消息的详细信息</td>
</tr>
<tr>
<td>int</td>
<td>getMessageReference()<br />获取请求/响应消息的唯一引用号</td>
</tr>
<tr>
<td>void</td>
<td>setInterceptAction(int interceptAction)<br />设置更新拦截操作</td>
</tr>
</tbody>
</table>
<h3 id="iintruderpayloadgenerator">IIntruderPayloadGenerator</h3>
<p>​		此接口被用于自定义 Intruder 工具的 payload 生成器。当需要发起一次新的 Intruder 攻击时，扩展需要注册一个 IIntruderPayloadGeneratorFactory 工厂并且必须返回此接口的一个新的实例。此接口会将当前插件注册为一个 Intruder 工具的 payload 生成器。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>byte[]</td>
<td>getNextPayload(byte[] baseValue)<br />此方法由 Burp 调用，用于获取下一个 payload</td>
</tr>
<tr>
<td>boolean</td>
<td>hasMorePayloads()<br />此方法由 Burp 调用，用于决定 payload 生成器是否能够提供更多 payload</td>
</tr>
<tr>
<td>void</td>
<td>reset()<br />此方法由 Burp 调用，用于重置 payload 生成器的状态，这将导致下一次调用 getNextPayload() 方法时会返回第一条 payload</td>
</tr>
</tbody>
</table>
<p>示例代码：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">,</span> IIntruderPayloadGeneratorFactory<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setExtensionName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 将当前插件注册为一个 Intruder 工具的 payload 生成器
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">registerIntruderPayloadGeneratorFactory</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> String <span style="color:#50fa7b">getGeneratorName</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 设置 payload 生成器名称
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#34;自定义 payload 生成器&#34;</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> IIntruderPayloadGenerator <span style="color:#50fa7b">createNewInstance</span><span style="color:#ff79c6">(</span>IIntruderAttack attack<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 返回一个新的 payload 生成器的实例
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">new</span> IntruderPayloadGenerator<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// 实现 IIntruderPayloadGenerator 接口，此接口提供的方法是由 Burp 来调用的
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">IntruderPayloadGenerator</span> <span style="color:#8be9fd;font-style:italic">implements</span> IIntruderPayloadGenerator<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        @Override
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">boolean</span> <span style="color:#50fa7b">hasMorePayloads</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#6272a4">// TODO here
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>            <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        @Override
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> <span style="color:#50fa7b">getNextPayload</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> baseValue<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#6272a4">// TODO here
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>            <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        @Override
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">reset</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#6272a4">// TODO here
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/imgs/image-20210823092128882.png" alt="image-20210823092128882"></p>
<h3 id="iintruderpayloadgeneratorfactory">IIntruderPayloadGeneratorFactory</h3>
<p>​		通过实现该接口，可以调用 IBurpExtenderCallbacks.registerIntruderPayloadGeneratorFactory() 注册一个自定义的 Intruder 工具的 payload 生成器。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>IIntruderPayloadGenerator</td>
<td>createNewInstance(IIntruderAttack attack)<br />此方法由 Burp 调用，用于创建一个 payload 生成器的新实例。当用户发动一次 Intruder 攻击时，将会使用该方法返回的 payload 生成器的实例</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getGeneratorName()<br />此方法由 Burp 调用，用于获取 payload 生成器的名称</td>
</tr>
</tbody>
</table>
<h3 id="iintruderpayloadprocessor">IIntruderPayloadProcessor</h3>
<p>​		通过实现该接口，可以调用 IBurpExtenderCallbacks.registerIntruderPayloadProcessor() 注册一个自定义  Intruder 工具的 payload 的处理器。此接口会将当前插件注册为一个 Intruder 工具的 payload 处理器。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>java.lang.String</td>
<td>getProcessorName()<br />此方法由 Burp 调用，用于获取 payload 处理器的名称</td>
</tr>
<tr>
<td>byte[]</td>
<td>processPayload(byte[] currentPayload, byte[] originalPayload, byte[] baseValue)<br />此方法由 Burp 调用，当处理器每次应用 payload 到一次 Intruder 攻击时,Burp 都会调用一次此方法<br />参数说明：<br />- currentPayload - 当前已被处理过的 payload 的值<br />- originalPayload - 在应用处理规则之前的 payload 的原始值<br />- baseValue - payload 位置的基准值，将用当前已被处理过的 payload 替代<br />- 返回值：返回已被处理过的 payload 的值。 如果返回 null 意味着当前的 payload 将被跳过,并且此次攻击将被直接移动到下一个 payload 。</td>
</tr>
</tbody>
</table>
<p>示例代码：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">,</span> IIntruderPayloadProcessor<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setExtensionName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 将当前插件注册为一个 Intruder 工具的 payload 处理器
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">registerIntruderPayloadProcessor</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// 此方法由 Burp 调用
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> String <span style="color:#50fa7b">getProcessorName</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 设置自定义 payload 处理器的名称
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#34;自定义 payload 处理器&#34;</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// 此方法由 Burp 调用，且会在每次使用一个 payload 发动攻击时都会调用一次此方法
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> <span style="color:#50fa7b">processPayload</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> currentPayload<span style="color:#ff79c6">,</span> <span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> originalPayload<span style="color:#ff79c6">,</span>
</span></span><span style="display:flex;"><span>                                 <span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> baseValue<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// TODO here
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/imgs/image-20210823095900504.png" alt="image-20210823095900504"></p>
<h3 id="imessageeditor">IMessageEditor</h3>
<p>​		此接口被用于使用 Burp 的 HTTP 消息编辑框的实例提供扩展功能，以便扩展插件可以在它自己的 UI 中使用消息编辑框，扩展插件可以通过调用 IBurpExtenderCallbacks.createMessageEditor() 获得此接口的实例。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>java.awt.Component</td>
<td>getComponent()<br />此方法返回了编辑器的 UI 组件，扩展插件可以将其添加到自己的 UI 中</td>
</tr>
<tr>
<td>byte[]</td>
<td>getMessage()<br />此方法用于获取当前已显示的消息，此消息可能已被用户修改</td>
</tr>
<tr>
<td>byte[]</td>
<td>getSelectedData()<br />此方法返回了用户当前所选择的数据</td>
</tr>
<tr>
<td>boolean</td>
<td>isMessageModified()<br />此方法用于决定当前的消息是否可被用户修改</td>
</tr>
<tr>
<td>void</td>
<td>setMessage(byte[] message, boolean isRequest)<br />此方法用于将一个 HTTP 消息显示在编辑器中</td>
</tr>
</tbody>
</table>
<h3 id="imessageeditortab">IMessageEditorTab</h3>
<p>​		扩展插件通过注册 IMessageEditorTabFactory 工厂，此工厂的 createNewInstance 返回一个当前接口的实例，Burp 将会在其 HTTP 消息编辑器中创建自定义的标签页。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>byte[]</td>
<td>getMessage()<br />此方法返回当前显示的消息</td>
</tr>
<tr>
<td>byte[]</td>
<td>getSelectedData()<br />此方法用于获取当前已被用户选择的数据</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getTabCaption()<br />此方法返回自定义标签页的标题</td>
</tr>
<tr>
<td>java.awt.Component</td>
<td>getUiComponent()<br />此方法返回自定义标签页内容的组件</td>
</tr>
<tr>
<td>boolean</td>
<td>isEnabled(byte[] content, boolean isRequest)<br />此方法用于指示在显示一个新的 HTTP 消息时，是否启用自定义的标签页</td>
</tr>
<tr>
<td>boolean</td>
<td>isModified()<br />此方法用于决定当前显示的消息是否可被用户修改</td>
</tr>
<tr>
<td>void</td>
<td>setMessage(byte[] content, boolean isRequest)<br />此方法可以显示一个新的消息或者清空已存在的消息</td>
</tr>
</tbody>
</table>
<h3 id="imessageeditorcontroller">IMessageEditorController</h3>
<p>​		此接口被用于 IMessageEditor 获取当前显示的消息的细节。创建了 Burp 的 HTTP 消息编辑器实例的扩展插件可以有选择的实现 IMessageEditorController 接口，当扩展插件需要当前消息的其他信息时，编辑器将会调用此接口（例如：发送当前消息到其他的 Burp 工具中）。扩展通过 IMessageEditorTabFactory 工厂提供自定义的编辑器标签页，此工厂的 createNewInstance 方法接受一个由该工厂所生成的每一个标签页的 IMessageEditorController 对象的引用，当标签页需要当前消息的其他信息时，则会调用该对象。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>IHttpService</td>
<td>getHttpService()<br />此方法用于获取当前消息的 HTTP 服务信息</td>
</tr>
<tr>
<td>byte[]</td>
<td>getRequest()<br />此方法用于获取当前消息的 HTTP 请求（也有可能是一个响应消息）</td>
</tr>
<tr>
<td>byte[]</td>
<td>getResponse()<br />此方法用于获取当前消息的 HTTP 响应（也有可能是一个请求消息）</td>
</tr>
</tbody>
</table>
<h3 id="imessageeditortabfactory">IMessageEditorTabFactory</h3>
<p>​		通过实现该接口，可以调用 IBurpExtenderCallbacks.registerMessageEditorTabFactory() 注册一个自定义的消息编辑器标签页的工厂。扩展插件可以在 Burp 的 HTTP 编辑器中渲染或编辑 HTTP 消息。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>IMessageEditorTab</td>
<td>createNewInstance(IMessageEditorController controller, boolean editable)<br />Burp 将会对每一个 HTTP 消息编辑器调用一次此方法，此工厂必须返回一个新的 IMessageEditorTab 对象</td>
</tr>
</tbody>
</table>
<p>示例代码：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>#<span style="color:#ff79c6">!</span>java
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.awt.Component<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.io.PrintWriter<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">,</span> IMessageEditorTabFactory<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> PrintWriter stdout<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> IExtensionHelpers helpers<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">stdout</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> PrintWriter<span style="color:#ff79c6">(</span>callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getStdout</span><span style="color:#ff79c6">(),</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">callbacks</span> <span style="color:#ff79c6">=</span> callbacks<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">helpers</span> <span style="color:#ff79c6">=</span> callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getHelpers</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setExtensionName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">registerMessageEditorTabFactory</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> IMessageEditorTab <span style="color:#50fa7b">createNewInstance</span><span style="color:#ff79c6">(</span>
</span></span><span style="display:flex;"><span>            IMessageEditorController controller<span style="color:#ff79c6">,</span> <span style="color:#8be9fd">boolean</span> editable<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 返回 IMessageEditorTab 的实例
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">new</span> iMessageEditorTab<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">iMessageEditorTab</span> <span style="color:#8be9fd;font-style:italic">implements</span> IMessageEditorTab<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 创建一个新的文本编辑器
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#8be9fd;font-style:italic">private</span> ITextEditor iTextEditor <span style="color:#ff79c6">=</span> callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">createTextEditor</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        @Override
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">public</span> String <span style="color:#50fa7b">getTabCaption</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#6272a4">// 设置消息编辑器标签页的标题
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>            <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#34;测试 MessageEditorTab&#34;</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        @Override
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">public</span> Component <span style="color:#50fa7b">getUiComponent</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#6272a4">// 返回 iTextEditor 的组件信息，当然也可以放置其他的组件
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>            <span style="color:#ff79c6">return</span> iTextEditor<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getComponent</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        @Override
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">boolean</span> <span style="color:#50fa7b">isEnabled</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> content<span style="color:#ff79c6">,</span> <span style="color:#8be9fd">boolean</span> isRequest<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#6272a4">// 在显示一个新的 HTTP 消息时，启用自定义的标签页
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>            <span style="color:#6272a4">// 通过 content 和 isRequest 也可以对特定的消息进行设置
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>            <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        @Override
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">setMessage</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> content<span style="color:#ff79c6">,</span> <span style="color:#8be9fd">boolean</span> isRequest<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#6272a4">// 把请求消息里面的 data 参数进行 Base64 编码操作
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>            <span style="color:#6272a4">// 这里并未处理参数中没有 data 时的异常
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>            IParameter parameter <span style="color:#ff79c6">=</span> helpers<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getRequestParameter</span><span style="color:#ff79c6">(</span>content<span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;data&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>            stdout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;data = &#34;</span> <span style="color:#ff79c6">+</span> parameter<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getValue</span><span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>            iTextEditor<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setText</span><span style="color:#ff79c6">(</span>helpers<span style="color:#ff79c6">.</span><span style="color:#50fa7b">stringToBytes</span><span style="color:#ff79c6">(</span>helpers<span style="color:#ff79c6">.</span><span style="color:#50fa7b">base64Encode</span><span style="color:#ff79c6">(</span>parameter<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getValue</span><span style="color:#ff79c6">())));</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        @Override
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> <span style="color:#50fa7b">getMessage</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#6272a4">// 获取 iTextEditor 的文本
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>            <span style="color:#ff79c6">return</span> iTextEditor<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getText</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        @Override
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">boolean</span> <span style="color:#50fa7b">isModified</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#6272a4">// 允许用户修改当前的消息
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>            <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        @Override
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">byte</span><span style="color:#ff79c6">[]</span> <span style="color:#50fa7b">getSelectedData</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#6272a4">// 直接返回 iTextEditor 中选中的文本
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>            <span style="color:#ff79c6">return</span> iTextEditor<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getSelectedText</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><img src="/imgs/image-20210823104309570.png" alt="image-20210823104309570" style="zoom:50%;" />
<h3 id="iparameter">IParameter</h3>
<p>​		此接口用于操控 HTTP 请求参数，开发者通过此接口可以灵活的获取请求或响应里的参数。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>java.lang.String</td>
<td>getName()<br />此方法用于获取参数名称</td>
</tr>
<tr>
<td>int</td>
<td>getNameEnd()<br />此方法用于获取在 HTTP 请求里面的最后一个参数的名称</td>
</tr>
<tr>
<td>int</td>
<td>getNameStart()<br />此方法用于获取在 HTTP 请求里面的第一个参数的名称</td>
</tr>
<tr>
<td>byte</td>
<td>getType()<br />此方法用于获取参数类型，参数的类型在 IParameter 接口中有定义，可以用来判断当前参数在数据包中的什么位置，例如是URL中还是Cookie中等。</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getValue()<br />此方法用于获取参数的值</td>
</tr>
<tr>
<td>int</td>
<td>getValueEnd()<br />此方法用于获取最后一个参数的值</td>
</tr>
<tr>
<td>int</td>
<td>getValueStart()<br />此方法用于获取第一个参数的值</td>
</tr>
</tbody>
</table>
<p>示例代码：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.io.PrintWriter<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.util.List<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">,</span> IHttpListener<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> PrintWriter stdout<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> IExtensionHelpers helpers<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">stdout</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> PrintWriter<span style="color:#ff79c6">(</span>callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getStdout</span><span style="color:#ff79c6">(),</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">callbacks</span> <span style="color:#ff79c6">=</span> callbacks<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">helpers</span> <span style="color:#ff79c6">=</span> callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getHelpers</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setExtensionName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">registerHttpListener</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">processHttpMessage</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd">int</span> toolFlag<span style="color:#ff79c6">,</span> <span style="color:#8be9fd">boolean</span> messageIsRequest<span style="color:#ff79c6">,</span>IHttpRequestResponse messageInfo<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 获取请求中的参数
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">if</span><span style="color:#ff79c6">(</span>messageIsRequest<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>            IRequestInfo iRequestInfo <span style="color:#ff79c6">=</span> helpers<span style="color:#ff79c6">.</span><span style="color:#50fa7b">analyzeRequest</span><span style="color:#ff79c6">(</span>messageInfo<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#6272a4">// 获取请求中的所有参数
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>            List<span style="color:#ff79c6">&lt;</span>IParameter<span style="color:#ff79c6">&gt;</span> iParameters <span style="color:#ff79c6">=</span> iRequestInfo<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getParameters</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">(</span>IParameter iParameter <span style="color:#ff79c6">:</span> iParameters<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">if</span><span style="color:#ff79c6">(</span>iParameter<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getType</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">==</span> IParameter<span style="color:#ff79c6">.</span><span style="color:#50fa7b">PARAM_URL</span><span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>                    stdout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;参数：&#34;</span> <span style="color:#ff79c6">+</span> iParameter<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getName</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34; 在 URL中&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>                    stdout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;参数：&#34;</span> <span style="color:#ff79c6">+</span> iParameter<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getName</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34; 的值为：&#34;</span> <span style="color:#ff79c6">+</span> iParameter<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getValue</span><span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>先发送一个包：</p>
<p><img src="/imgs/image-20210823104958264.png" alt="image-20210823104958264"></p>
<p>查看输出</p>
<p><img src="/imgs/image-20210823105026403.png" alt="image-20210823105026403"></p>
<p>获取Cookie:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.io.PrintWriter;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.util.List;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>public class BurpExtender implements IBurpExtender, IHttpListener{
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    public PrintWriter stdout;
</span></span><span style="display:flex;"><span>    public IExtensionHelpers helpers;
</span></span><span style="display:flex;"><span>    private IBurpExtenderCallbacks callbacks;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    public void <span style="color:#50fa7b">registerExtenderCallbacks</span>(final IBurpExtenderCallbacks callbacks){
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        this.stdout = new <span style="color:#50fa7b">PrintWriter</span>(callbacks.<span style="color:#50fa7b">getStdout</span>(), <span style="color:#ff79c6">true</span>);
</span></span><span style="display:flex;"><span>        this.callbacks = callbacks;
</span></span><span style="display:flex;"><span>        this.helpers = callbacks.<span style="color:#50fa7b">getHelpers</span>();
</span></span><span style="display:flex;"><span>        callbacks.<span style="color:#50fa7b">setExtensionName</span>(<span style="color:#f1fa8c">&#34;rebootORZ&#34;</span>);
</span></span><span style="display:flex;"><span>        callbacks.<span style="color:#50fa7b">registerHttpListener</span>(this);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    public void <span style="color:#50fa7b">processHttpMessage</span>(<span style="color:#8be9fd">int</span> toolFlag, boolean messageIsRequest,IHttpRequestResponse messageInfo) {
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 获取请求中的参数
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">if</span>(messageIsRequest){
</span></span><span style="display:flex;"><span>            IRequestInfo iRequestInfo = helpers.<span style="color:#50fa7b">analyzeRequest</span>(messageInfo);
</span></span><span style="display:flex;"><span>            <span style="color:#6272a4">// 获取请求中的所有参数
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>            List&lt;IParameter&gt; iParameters = iRequestInfo.<span style="color:#50fa7b">getParameters</span>();
</span></span><span style="display:flex;"><span>            String cookie = <span style="color:#f1fa8c">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">for</span> (IParameter iParameter : iParameters) {
</span></span><span style="display:flex;"><span>                        <span style="color:#6272a4">//判断参数是否在Cookie中，如果是的话，将这些参数和值提取出来就是当前的Cookie了
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                <span style="color:#ff79c6">if</span> (iParameter.<span style="color:#50fa7b">getType</span>() <span style="color:#ff79c6">==</span> IParameter.PARAM_COOKIE) {
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">if</span>(cookie <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#34;&#34;</span>){
</span></span><span style="display:flex;"><span>                        cookie = iParameter.<span style="color:#50fa7b">getName</span>()<span style="color:#ff79c6">+</span><span style="color:#f1fa8c">&#34;=&#34;</span><span style="color:#ff79c6">+</span>iParameter.<span style="color:#50fa7b">getValue</span>();
</span></span><span style="display:flex;"><span>                    }<span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>                        cookie = cookie <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;&amp;&#34;</span> <span style="color:#ff79c6">+</span> iParameter.<span style="color:#50fa7b">getName</span>()<span style="color:#ff79c6">+</span><span style="color:#f1fa8c">&#34;=&#34;</span><span style="color:#ff79c6">+</span>iParameter.<span style="color:#50fa7b">getValue</span>();
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            stdout.<span style="color:#8be9fd;font-style:italic">println</span>(cookie);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/imgs/image-20210823210858201.png" alt="image-20210823210858201"></p>
<h3 id="iproxylistener">IProxyListener</h3>
<p>​		扩展可以实现此接口，并且可以通过调用 IBurpExtenderCallbacks.registerProxyListener()注册一个代理监听器。在代理工具处理了请求或响应后会通知此监听器。扩展插件通过注册这样一个监听器，对这些消息执行自定义的分析或修改操作。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>参数和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>void</td>
<td>processProxyMessage(boolean messageIsRequest, IInterceptedProxyMessage message)<br />当代理工具处理 HTTP 消息时则会调用此方法</td>
</tr>
</tbody>
</table>
<p>示例代码：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.io.PrintWriter<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">,</span> IProxyListener<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> PrintWriter stdout<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> IExtensionHelpers helpers<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">stdout</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> PrintWriter<span style="color:#ff79c6">(</span>callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getStdout</span><span style="color:#ff79c6">(),</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">callbacks</span> <span style="color:#ff79c6">=</span> callbacks<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">helpers</span> <span style="color:#ff79c6">=</span> callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getHelpers</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setExtensionName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">registerProxyListener</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">processProxyMessage</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd">boolean</span> messageIsRequest<span style="color:#ff79c6">,</span>IInterceptedProxyMessage message<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// TODO here
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        stdout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;测试 IProxyListener&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>先抓个包：</p>
<p><img src="/imgs/image-20210823110556727.png" alt="image-20210823110556727"></p>
<p>再去查看插件的输出：</p>
<img src="/imgs/image-20210823110616651.png" alt="image-20210823110616651" style="zoom:50%;" />
<h3 id="irequestinfo">IRequestInfo</h3>
<p>​		此接口被用于获取一个 HTTP 请求的详细信息。扩展插件可以通过调用 IExtensionHelpers.analyzeRequest() 获得一个 IRequestInfo 对象。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>int</td>
<td>getBodyOffset()<br />此方法用于获取 HTTP body 在请求消息中的起始偏移量</td>
</tr>
<tr>
<td>byte</td>
<td>getContentType()<br />此方法用于获取请求消息的 HTTP 类型</td>
</tr>
<tr>
<td>java.util.List&lt;java.lang.String&gt;</td>
<td>getHeaders()<br />此方法用于获取请求中包含的 HTTP 头</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getMethod()<br />此方法用于获取请求的 HTTP 方法</td>
</tr>
<tr>
<td>java.util.List<IParameter></td>
<td>getParameters()<br />此方法用于获取请求中包含的参数</td>
</tr>
<tr>
<td>java.net.URL</td>
<td>getUrl()<br />此方法用于获取请求中的 URL</td>
</tr>
</tbody>
</table>
<p>示例代码：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.io.PrintWriter<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">,</span> IHttpListener<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> PrintWriter stdout<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> IExtensionHelpers helpers<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">stdout</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> PrintWriter<span style="color:#ff79c6">(</span>callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getStdout</span><span style="color:#ff79c6">(),</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">helpers</span> <span style="color:#ff79c6">=</span> callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getHelpers</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setExtensionName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">registerHttpListener</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">processHttpMessage</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd">int</span> toolFlag<span style="color:#ff79c6">,</span> <span style="color:#8be9fd">boolean</span> messageIsRequest<span style="color:#ff79c6">,</span>
</span></span><span style="display:flex;"><span>                                   IHttpRequestResponse messageInfo<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 打印出请求的 Url 和 响应码
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">if</span><span style="color:#ff79c6">(</span>messageIsRequest<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>            stdout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span>helpers<span style="color:#ff79c6">.</span><span style="color:#50fa7b">bytesToString</span><span style="color:#ff79c6">(</span>messageInfo<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getRequest</span><span style="color:#ff79c6">()));</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">else</span><span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            IResponseInfo responseInfo <span style="color:#ff79c6">=</span> helpers<span style="color:#ff79c6">.</span><span style="color:#50fa7b">analyzeResponse</span><span style="color:#ff79c6">(</span>messageInfo<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getResponse</span><span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd">short</span> statusCode <span style="color:#ff79c6">=</span> responseInfo<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getStatusCode</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>            stdout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">printf</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;响应码 =&gt; %d\r\n&#34;</span><span style="color:#ff79c6">,</span> statusCode<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>先发包：</p>
<p><img src="/imgs/image-20210823111119934.png" alt="image-20210823111119934"></p>
<p>看输出：</p>
<p><img src="/imgs/image-20210823111135863.png" alt="image-20210823111135863"></p>
<h3 id="iresponseinfo">IResponseInfo</h3>
<p>​		此接口被用于获取一个 HTTP 请求的详细信息。扩展插件可以通过调用 IExtensionHelpers. analyzeResponse() 获得一个 IResponseInfo 对象。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>int</td>
<td>getBodyOffset()<br />此方法用于获取 HTTP body 在响应消息中的起始偏移量</td>
</tr>
<tr>
<td>java.util.List<ICookie></td>
<td>getCookies()<br />此方法用于获取响应消息中设置的 HTTP Cookie</td>
</tr>
<tr>
<td>java.util.List&lt;java.lang.String&gt;</td>
<td>getHeaders()<br />此方法用于获取包含在响应消息中的 HTTP 头</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getInferredMimeType()<br />此方法用于获取根据 HTTP 响应判断出的 MIME 类型</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getStatedMimeType()<br />此方法用于获取 HTTP 响应头中指示的 MIME 类型</td>
</tr>
<tr>
<td>short</td>
<td>getStatusCode()<br />此方法用于获取 HTTP 状态码</td>
</tr>
</tbody>
</table>
<p>同理，发包后看输出：</p>
<p><img src="/imgs/image-20210823111557973.png" alt="image-20210823111557973"></p>
<h3 id="iscanissue">IScanIssue</h3>
<p>​		此接口用于获取 Scanner 工具扫描到的问题的细节。扩展可以通过注册一个 IScannerListener或者是通过调用IBurpExtenderCallbacks.getScanIssues() 获取扫描问题的细节。扩展同样可以通过注册 IScannerCheck 接口或者是调用IBurpExtenderCallbacks.addScanIssue() 方法来自定义扫描问题，此时扩展需要提供它对此接口的实现。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>java.lang.String</td>
<td>getConfidence()<br />此方法返回扫描问题的信任等级</td>
</tr>
<tr>
<td>IHttpRequestResponse[]</td>
<td>getHttpMessages()<br />此方法返回生成扫描问题所对应的 HTTP 消息</td>
</tr>
<tr>
<td>IHttpService</td>
<td>getHttpService()<br />此方法返回生成扫描问题所对应的 HTTP 服务信息</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getIssueBackground()<br />此方法返回指定扫描问题类型的背景描述信息</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getIssueDetail()<br />此方法返回指定的扫描问题的详细信息</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getIssueName()<br />此方法返回扫描问题类型的名称</td>
</tr>
<tr>
<td>int</td>
<td>getIssueType()<br />此方法返回扫描问题类型的数字标志符</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getRemediationBackground()<br />此方法返回指定扫描问题的解决方式的背景描述信息</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getRemediationDetail()<br />此方法返回指定扫描问题的解决方式的背景详情</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getSeverity()<br />此方法返回扫描问题的错误等级</td>
</tr>
<tr>
<td>java.net.URL</td>
<td>getUrl()<br />此方法返回生成扫描问题对应的 URL 信息</td>
</tr>
</tbody>
</table>
<h3 id="iscannercheck">IScannerCheck</h3>
<p>​		扩展可以实现此接口，之后可以通过调用 IBurpExtenderCallbacks.registerScannerCheck()注册一个自定义的 Scanner 工具的检查器。Burp 将会告知检查器执行“主动扫描”或“被动扫描”，并且在确认扫描到问题时给出报告。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>int</td>
<td>consolidateDuplicateIssues(IScanIssue existingIssue, IScanIssue newIssue)<br />当自定义的Scanner工具的检查器针对同一个 URL 路径报告了多个扫描问题时，Scanner 工具会调用此方法</td>
</tr>
<tr>
<td>java.util.List<IScanIssue></td>
<td>doActiveScan(IHttpRequestResponse baseRequestResponse, IScannerInsertionPoint insertionPoint)<br />Scanner 工具会对每一个可插入的点执行“主动扫描”</td>
</tr>
<tr>
<td>java.util.List<IScanIssue></td>
<td>doPassiveScan(IHttpRequestResponse baseRequestResponse)<br />Scanner 工具会对每一个可插入的点执行“被动扫描”</td>
</tr>
</tbody>
</table>
<p>示例代码：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.io.PrintWriter<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.util.List<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">,</span> IScannerCheck<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> PrintWriter stdout<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> IExtensionHelpers helpers<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">stdout</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> PrintWriter<span style="color:#ff79c6">(</span>callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getStdout</span><span style="color:#ff79c6">(),</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">helpers</span> <span style="color:#ff79c6">=</span> callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getHelpers</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setExtensionName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">registerScannerCheck</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> List<span style="color:#ff79c6">&lt;</span>IScanIssue<span style="color:#ff79c6">&gt;</span> <span style="color:#50fa7b">doPassiveScan</span><span style="color:#ff79c6">(</span>
</span></span><span style="display:flex;"><span>            IHttpRequestResponse baseRequestResponse<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// TODO here
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        stdout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;执行doPassiveScan&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> List<span style="color:#ff79c6">&lt;</span>IScanIssue<span style="color:#ff79c6">&gt;</span> <span style="color:#50fa7b">doActiveScan</span><span style="color:#ff79c6">(</span>
</span></span><span style="display:flex;"><span>            IHttpRequestResponse baseRequestResponse<span style="color:#ff79c6">,</span>
</span></span><span style="display:flex;"><span>            IScannerInsertionPoint insertionPoint<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// TODO here
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        stdout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;执行doActiveScan&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">int</span> <span style="color:#50fa7b">consolidateDuplicateIssues</span><span style="color:#ff79c6">(</span>IScanIssue existingIssue<span style="color:#ff79c6">,</span>
</span></span><span style="display:flex;"><span>                                          IScanIssue newIssue<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// TODO here
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        stdout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;执行consolidateDuplicateIssues&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> 0<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>对一个数据包进行scan-crawler and audit，当扫描执行到不同阶段时，会按照我们指定的代码输出如下内容：</p>
<p><img src="/imgs/image-20210823113101769.png" alt="image-20210823113101769"></p>
<h3 id="iscannerinsertionpoint">IScannerInsertionPoint</h3>
<p>​		此接口被用于定义一个用于Scanner工具检查器扫描的插入点。扩展可以通过注册 IScannerCheck 获得此接口实例，或者通过注册 IScannerInsertionPointProvider 创建一个 Burp 所使用的扫描检查器实例。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>byte[]</td>
<td>buildRequest(byte[] payload)<br />此方法用于使用指定的 payload 在插入点构建一个请求</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getBaseValue()<br />此方法返回插入点的基本值</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getInsertionPointName()<br />此方法返回插入点的名称</td>
</tr>
<tr>
<td>byte</td>
<td>getInsertionPointType()<br />此方法返回插入点的类型，插入点类型在IScannerInsertionPoint接口中定义</td>
</tr>
<tr>
<td>int[]</td>
<td>getPayloadOffsets(byte[] payload)<br />当使用指定的 payload 替换到插入点时，此方法可以决定 payload 在请求中的偏移量</td>
</tr>
</tbody>
</table>
<h3 id="iscannerinsertionpointprovider">IScannerInsertionPointProvider</h3>
<p>通过实现该接口，可以通过调用 IBurpExtenderCallbacks.registerScannerInsertionPointProvider() 注册自定义扫描插入点的工厂。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>java.util.List<IScannerInsertionPoint></td>
<td>getInsertionPoints(IHttpRequestResponse baseRequestResponse)<br />当扫描请求为“主动扫描”时， Scanner 工具将会调用此方法，并且提供者应该提供一个自定义插入点的列表以便用于扫描。</td>
</tr>
</tbody>
</table>
<h3 id="iscannerlistener">IScannerListener</h3>
<p>​		通过实现该接口，可以通过调用 IBurpExtenderCallbacks.registerScannerListener() 注册一个 Scanner 工具的监听器。当 Scanner 工具扫描到新的问题时，会通知此监听器。扩展通过注册这样的监听器用于针对扫描问题自定义的分析和记录。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>void</td>
<td>newScanIssue(IScanIssue issue)<br />当一个新的扫描问题被添加到 Burp 的Scanner工具的扫描结果中时，此方法将被 Burp 调用</td>
</tr>
</tbody>
</table>
<p>示例代码：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.io.PrintWriter<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">,</span> IScannerListener<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> PrintWriter stdout<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> IExtensionHelpers helpers<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">stdout</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> PrintWriter<span style="color:#ff79c6">(</span>callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getStdout</span><span style="color:#ff79c6">(),</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">helpers</span> <span style="color:#ff79c6">=</span> callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getHelpers</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setExtensionName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">registerScannerListener</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">newScanIssue</span><span style="color:#ff79c6">(</span>IScanIssue issue<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// TODO Auto-generated method stub
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        stdout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;扫描到新的问题 :&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        stdout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;url =&gt; &#34;</span> <span style="color:#ff79c6">+</span> issue<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getUrl</span><span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>        stdout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;详情 =&gt; &#34;</span> <span style="color:#ff79c6">+</span> issue<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getIssueDetail</span><span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>使用scanner进行扫描并查看输出：</p>
<p><img src="/imgs/image-20210823125931776.png" alt="image-20210823125931776"></p>
<h3 id="iscanqueueitem">IScanQueueItem</h3>
<p>​		此接口被用于获取在 Burp 的 Scanner 工具中激活的扫描队列里的项目详情。扩展可以通过调用IBurpExtenderCallbacks.doActiveScan() 获得扫描队列项目的引用。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>void</td>
<td>cancel()<br />此方法可以取消扫描队列项目中的扫描状态</td>
</tr>
<tr>
<td>IScanIssue[]</td>
<td>getIssues()<br />获取扫描队列项目生成的问题的细节</td>
</tr>
<tr>
<td>int</td>
<td>getNumErrors()<br />此方法返回扫描队列项目发生错误时的网络错误号</td>
</tr>
<tr>
<td>int</td>
<td>getNumInsertionPoints()<br />此方法返回扫描队列项目的攻击插入点的数量</td>
</tr>
<tr>
<td>int</td>
<td>getNumRequests()<br />此方法返回扫描队列项目已经发出的请求的数量</td>
</tr>
<tr>
<td>byte</td>
<td>getPercentageComplete()<br />此方法返回扫描队列项目中已经完成扫描的百分比</td>
</tr>
<tr>
<td>java.lang.String</td>
<td>getStatus()<br />此方法返回扫描队列项目的状态描述</td>
</tr>
</tbody>
</table>
<h3 id="iscopechangelistener">IScopeChangeListener</h3>
<p>​		通过实现该接口，可以通过调用 IBurpExtenderCallbacks.registerScopeChangeListener() 注册一个 Target  工具下的 scope 变化监听器。当 Burp 的 Target 工具下的 scope 发生变化时，将会通知此接口。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>void</td>
<td>scopeChanged()<br />当 Burp 的 Target 工具下的 scope 发生变化时，将会调用此方法。</td>
</tr>
</tbody>
</table>
<p>示例代码：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.io.PrintWriter<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">,</span> IScopeChangeListener<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> PrintWriter stdout<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> IExtensionHelpers helpers<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">stdout</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> PrintWriter<span style="color:#ff79c6">(</span>callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getStdout</span><span style="color:#ff79c6">(),</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">helpers</span> <span style="color:#ff79c6">=</span> callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getHelpers</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setExtensionName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">registerScopeChangeListener</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">scopeChanged</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 手动添加或右键菜单添加目标到 scope 列表，就会执行此方法
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        stdout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;scope 有变化！&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>添加到Scope查看插件输出：</p>
<img src="/imgs/image-20210823130554888.png" alt="image-20210823130554888" style="zoom:50%;" />
<img src="/imgs/image-20210823130615086.png" alt="image-20210823130615086" style="zoom:50%;" />
<h3 id="isessionhandlingaction">ISessionHandlingAction</h3>
<p>​		通过实现该接口，可以通过调用 IBurpExtenderCallbacks.registerSessionHandlingAction() 注册一个自定义的会话操作动作。每一个已注册的会话操作动作在会话操作规则的UI中都是可用的，并且用户可以选择其中一个作为会话操作行为的规则。用户可以选择直接调用操作，也可以按照宏定义调用操作。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>java.lang.String</td>
<td>getActionName()<br />此方法由 Burp 调用获取会话操作行为的名称</td>
</tr>
<tr>
<td>void</td>
<td>performAction(IHttpRequestResponse currentRequest, IHttpRequestResponse[] macroItems)<br />当会话操作行为被执行时会调用此方法</td>
</tr>
</tbody>
</table>
<h3 id="itab">ITab</h3>
<p>​		此接口用于自定义的标签页，调用 IBurpExtenderCallbacks.addSuiteTab() 方法可以在 Burp 的 UI 中显示自定义的标签页。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>java.lang.String</td>
<td>getTabCaption()<br />此方法用于获取自定义标签的标题文本</td>
</tr>
<tr>
<td>java.awt.Component</td>
<td>getUiComponent()<br />Burpsuit调用此方法获取自定义标签页显示的组件</td>
</tr>
</tbody>
</table>
<p>示例代码：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.awt.Component<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.io.PrintWriter<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> javax.swing.JButton<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> javax.swing.JPanel<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> javax.swing.SwingUtilities<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">,</span> ITab<span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> PrintWriter stdout<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> IExtensionHelpers helpers<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> JPanel jPanel1<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> JButton jButton1<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd;font-style:italic">final</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">){</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">stdout</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> PrintWriter<span style="color:#ff79c6">(</span>callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getStdout</span><span style="color:#ff79c6">(),</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">helpers</span> <span style="color:#ff79c6">=</span> callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getHelpers</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setExtensionName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        SwingUtilities<span style="color:#ff79c6">.</span><span style="color:#50fa7b">invokeLater</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> Runnable<span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            @Override
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">run</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">//创建一个 JPanel
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                jPanel1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JPanel<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>                jButton1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JButton<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;点我&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">// 将按钮添加到面板中
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                jPanel1<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>jButton1<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">//自定义的 UI 组件
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">customizeUiComponent</span><span style="color:#ff79c6">(</span>jPanel1<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">//将自定义的标签页添加到Burp UI 中
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">addSuiteTab</span><span style="color:#ff79c6">(</span>BurpExtender<span style="color:#ff79c6">.</span><span style="color:#50fa7b">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">});</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> String <span style="color:#50fa7b">getTabCaption</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 返回自定义标签页的标题
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#34;rebootORZ&#34;</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> Component <span style="color:#50fa7b">getUiComponent</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 返回自定义标签页中的面板的组件对象
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">return</span> jPanel1<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/imgs/image-20210823133524704.png" alt="image-20210823133524704"></p>
<h3 id="itempfile">ITempFile</h3>
<p>此接口用于操作调用 IBurpExtenderCallbacks.saveToTempFile() 创建的临时文件。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>void</td>
<td>delete()<br />删除临时文件，此方法已过时</td>
</tr>
<tr>
<td>byte[]</td>
<td>getBuffer()<br />此方法用于获取临时文件内容的缓冲区</td>
</tr>
</tbody>
</table>
<h3 id="itexteditor">ITextEditor</h3>
<p>​		此接口用于扩展 Burp的原始文本编辑器，扩展通过调用 IBurpExtenderCallbacks.createTextEditor() 获得一个此接口的实例。</p>
<table>
<thead>
<tr>
<th>修饰符和类型</th>
<th>方法和描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>java.awt.Component</td>
<td>getComponent()<br />此方法返回用于扩展添加自定义的编辑器的 UI 组件</td>
</tr>
<tr>
<td>byte[]</td>
<td>getSelectedText()<br />此方法用于获取当前的已选择的文本</td>
</tr>
<tr>
<td>int[]</td>
<td>getSelectionBounds()<br />此方法用于获取用户在已显示的文本中选择的边界</td>
</tr>
<tr>
<td>byte[]</td>
<td>getText()<br />此方法用于获取当前已显示的文本</td>
</tr>
<tr>
<td>boolean</td>
<td>isTextModified()<br />此方法用于指示用户是否对编辑器的内容做了修改</td>
</tr>
<tr>
<td>void</td>
<td>setEditable(boolean editable)<br />此方法用于决定当前的编辑器是否可编辑</td>
</tr>
<tr>
<td>void</td>
<td>setSearchExpression(java.lang.String expression)<br />此方法用于更新编辑器下边的搜索框的搜索表达式</td>
</tr>
<tr>
<td>void</td>
<td>setText(byte[] text)<br />此方法用于更新编辑器中当前已显示的文本</td>
</tr>
</tbody>
</table>
<h2 id="java-swing">Java Swing</h2>
<p>​	Swing是java图形化编程中用到的一个包，而swing本身又是基于awt包扩展出来的。在Burpsuit插件编写中图形化相关知识用的并不多，所以这里只列举常用控件，并给出部分综合应用的示例代码，相关控件的使用可以从示例中去理解或者自行百度即可。</p>
<h3 id="常用控件">常用控件</h3>
<table>
<thead>
<tr>
<th>控件</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>JLabel</td>
<td>标签控件，JLabel</td>
</tr>
<tr>
<td>JButton</td>
<td>按钮控件。</td>
</tr>
<tr>
<td>JColorChooser</td>
<td>颜色选择控件，用于让用户操作和选择颜色。</td>
</tr>
<tr>
<td>JCheckBox</td>
<td>选择框控件，支持分组。</td>
</tr>
<tr>
<td>JRadioButton</td>
<td>单选框控件，支持分组。</td>
</tr>
<tr>
<td>JList</td>
<td>列表控件。</td>
</tr>
<tr>
<td>JComboBox</td>
<td>组合框控件。</td>
</tr>
<tr>
<td>JTextField</td>
<td>文本框控件。</td>
</tr>
<tr>
<td>JPasswordField</td>
<td>密码输入框控件。</td>
</tr>
<tr>
<td>JTextArea</td>
<td>多行文本控件。</td>
</tr>
<tr>
<td>ImageIcon</td>
<td>绘制图标的控件。</td>
</tr>
<tr>
<td>JScrollbar</td>
<td>滚动条控件，支持水平和垂直滚动。</td>
</tr>
<tr>
<td>JFileChooser</td>
<td>选择文件对话框。</td>
</tr>
<tr>
<td>JProgressBar</td>
<td>进度条控件。</td>
</tr>
<tr>
<td>JPanel</td>
<td>面板控件，此控件在开发插件时会经常用到。</td>
</tr>
</tbody>
</table>
<h4 id="示例代码">示例代码</h4>
<p><strong>SwingLoginActionExample.java</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">83
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">84
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">85
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">86
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">87
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">import</span> javax.swing.JButton<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> javax.swing.JFrame<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> javax.swing.JLabel<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> javax.swing.JPanel<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> javax.swing.JPasswordField<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> javax.swing.JTextField<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.awt.event.ActionEvent<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.awt.event.ActionListener<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">SwingLoginActionExample</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">main</span><span style="color:#ff79c6">(</span>String<span style="color:#ff79c6">[]</span> args<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 创建 JFrame 实例
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        JFrame frame <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JFrame<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Login Example&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// Setting the width and height of frame
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        frame<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setSize</span><span style="color:#ff79c6">(</span>350<span style="color:#ff79c6">,</span> 200<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        frame<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setDefaultCloseOperation</span><span style="color:#ff79c6">(</span>JFrame<span style="color:#ff79c6">.</span><span style="color:#50fa7b">EXIT_ON_CLOSE</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">/* 创建面板，这个类似于 HTML 的 div 标签
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">         * 我们可以创建多个面板并在 JFrame 中指定位置
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">         * 面板中我们可以添加文本字段，按钮及其他组件。
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">         */</span>
</span></span><span style="display:flex;"><span>        JPanel panel <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JPanel<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 添加面板
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        frame<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>panel<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">/*
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">         * 调用用户定义的方法并添加组件到面板
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">         */</span>
</span></span><span style="display:flex;"><span>        placeComponents<span style="color:#ff79c6">(</span>panel<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 设置界面可见
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        frame<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setVisible</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">true</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">placeComponents</span><span style="color:#ff79c6">(</span>JPanel panel<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">/* 布局部分我们这边不多做介绍
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">         * 这边设置布局为 null
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">         */</span>
</span></span><span style="display:flex;"><span>        panel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setLayout</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">null</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 创建 JLabel
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        JLabel userLabel <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JLabel<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;User:&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">/* 这个方法定义了组件的位置。
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">         * setBounds(x, y, width, height)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">         * x 和 y 指定左上角的新位置，由 width 和 height 指定新的大小。
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">         */</span>
</span></span><span style="display:flex;"><span>        userLabel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setBounds</span><span style="color:#ff79c6">(</span>10<span style="color:#ff79c6">,</span>20<span style="color:#ff79c6">,</span>80<span style="color:#ff79c6">,</span>25<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        panel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>userLabel<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">/*
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">         * 创建文本域用于用户输入
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">         */</span>
</span></span><span style="display:flex;"><span>        JTextField userText <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JTextField<span style="color:#ff79c6">(</span>20<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        userText<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setBounds</span><span style="color:#ff79c6">(</span>100<span style="color:#ff79c6">,</span>20<span style="color:#ff79c6">,</span>165<span style="color:#ff79c6">,</span>25<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        panel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>userText<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//如果想要获取userText中用户输入的内容，不能直接在文本域这里创建监听事件，这样是获取不到内容的，需要在例如button的事件里面来获取（不知道为什么）
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 输入密码的文本域
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        JLabel passwordLabel <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JLabel<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Password:&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        passwordLabel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setBounds</span><span style="color:#ff79c6">(</span>10<span style="color:#ff79c6">,</span>50<span style="color:#ff79c6">,</span>80<span style="color:#ff79c6">,</span>25<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        panel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>passwordLabel<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">/*
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">         *这个类似用于输入的文本域
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">         * 但是输入的信息会以点号代替，用于包含密码的安全性
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">         */</span>
</span></span><span style="display:flex;"><span>        JPasswordField passwordText <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JPasswordField<span style="color:#ff79c6">(</span>20<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        passwordText<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setBounds</span><span style="color:#ff79c6">(</span>100<span style="color:#ff79c6">,</span>50<span style="color:#ff79c6">,</span>165<span style="color:#ff79c6">,</span>25<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        panel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>passwordText<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 创建登录按钮
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        JButton loginButton <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JButton<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;login&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        loginButton<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setBounds</span><span style="color:#ff79c6">(</span>10<span style="color:#ff79c6">,</span> 80<span style="color:#ff79c6">,</span> 80<span style="color:#ff79c6">,</span> 25<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        panel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>loginButton<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        loginButton<span style="color:#ff79c6">.</span><span style="color:#50fa7b">addActionListener</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> ActionListener<span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            @Override
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">actionPerformed</span><span style="color:#ff79c6">(</span>ActionEvent e<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">// 进行逻辑处理即可
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span>                System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">out</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">println</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;用户名为：&#34;</span> <span style="color:#ff79c6">+</span> userText<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getText</span><span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">});</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><img src="/imgs/image-20210823135401503.png" alt="image-20210823135401503" style="zoom:50%;" />
<p><strong>ListSelectionDemo.java</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">106
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">107
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">108
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">109
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">110
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">111
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">112
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">113
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">114
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">115
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">116
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">117
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">118
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">119
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">120
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">121
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">122
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">123
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">124
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">125
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">126
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">127
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">128
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">129
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">130
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">131
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">132
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">133
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">134
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">135
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">136
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">137
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">138
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">139
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">140
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">141
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">142
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">143
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">144
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">145
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">146
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">147
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">148
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">149
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">150
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">151
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">152
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">153
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">154
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">155
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#6272a4">//列表监听事件Demo
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> javax.swing.*<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> javax.swing.event.*<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> javax.swing.table.*<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.util.*<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.awt.*<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.awt.event.*<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">ListSelectionDemo</span> <span style="color:#8be9fd;font-style:italic">extends</span> JPanel <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>    JTextArea output<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    JList list<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    JTable table<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    String newline <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;\n&#34;</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    ListSelectionModel listSelectionModel<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#50fa7b">ListSelectionDemo</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">super</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> BorderLayout<span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        String<span style="color:#ff79c6">[]</span> listData <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span> <span style="color:#f1fa8c">&#34;one&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;two&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;three&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;four&#34;</span><span style="color:#ff79c6">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#34;five&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;six&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;seven&#34;</span> <span style="color:#ff79c6">};</span>
</span></span><span style="display:flex;"><span>        String<span style="color:#ff79c6">[]</span> columnNames <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span> <span style="color:#f1fa8c">&#34;French&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;Spanish&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;Italian&#34;</span> <span style="color:#ff79c6">};</span>
</span></span><span style="display:flex;"><span>        list <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JList<span style="color:#ff79c6">(</span>listData<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        listSelectionModel <span style="color:#ff79c6">=</span> list<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getSelectionModel</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        listSelectionModel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">addListSelectionListener</span><span style="color:#ff79c6">(</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">new</span> SharedListSelectionHandler<span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>        JScrollPane listPane <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JScrollPane<span style="color:#ff79c6">(</span>list<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        JPanel controlPane <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JPanel<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        String<span style="color:#ff79c6">[]</span> modes <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span> <span style="color:#f1fa8c">&#34;SINGLE_SELECTION&#34;</span><span style="color:#ff79c6">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#34;SINGLE_INTERVAL_SELECTION&#34;</span><span style="color:#ff79c6">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#34;MULTIPLE_INTERVAL_SELECTION&#34;</span> <span style="color:#ff79c6">};</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">final</span> JComboBox comboBox <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JComboBox<span style="color:#ff79c6">(</span>modes<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        comboBox<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setSelectedIndex</span><span style="color:#ff79c6">(</span>2<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        comboBox<span style="color:#ff79c6">.</span><span style="color:#50fa7b">addActionListener</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> ActionListener<span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">actionPerformed</span><span style="color:#ff79c6">(</span>ActionEvent e<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                String newMode <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">(</span>String<span style="color:#ff79c6">)</span>comboBox<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getSelectedItem</span><span style="color:#ff79c6">();</span> <span style="color:#6272a4">//获取当前下拉框选择的项内容
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>newMode<span style="color:#ff79c6">.</span><span style="color:#50fa7b">equals</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;SINGLE_SELECTION&#34;</span><span style="color:#ff79c6">))</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                    listSelectionModel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setSelectionMode</span><span style="color:#ff79c6">(</span>
</span></span><span style="display:flex;"><span>                            ListSelectionModel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SINGLE_SELECTION</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">}</span> <span style="color:#ff79c6">else</span> <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>newMode<span style="color:#ff79c6">.</span><span style="color:#50fa7b">equals</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;SINGLE_INTERVAL_SELECTION&#34;</span><span style="color:#ff79c6">))</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                    listSelectionModel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setSelectionMode</span><span style="color:#ff79c6">(</span>
</span></span><span style="display:flex;"><span>                            ListSelectionModel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SINGLE_INTERVAL_SELECTION</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">}</span> <span style="color:#ff79c6">else</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                    listSelectionModel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setSelectionMode</span><span style="color:#ff79c6">(</span>
</span></span><span style="display:flex;"><span>                            ListSelectionModel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">MULTIPLE_INTERVAL_SELECTION</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>                output<span style="color:#ff79c6">.</span><span style="color:#50fa7b">append</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;----------&#34;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;Mode: &#34;</span> <span style="color:#ff79c6">+</span> newMode
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;----------&#34;</span> <span style="color:#ff79c6">+</span> newline<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">});</span>
</span></span><span style="display:flex;"><span>        controlPane<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> JLabel<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Selection mode:&#34;</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        controlPane<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>comboBox<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//Build output area.
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        output <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JTextArea<span style="color:#ff79c6">(</span>1<span style="color:#ff79c6">,</span> 10<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        output<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setEditable</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">false</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        JScrollPane outputPane <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JScrollPane<span style="color:#ff79c6">(</span>output<span style="color:#ff79c6">,</span>
</span></span><span style="display:flex;"><span>                ScrollPaneConstants<span style="color:#ff79c6">.</span><span style="color:#50fa7b">VERTICAL_SCROLLBAR_ALWAYS</span><span style="color:#ff79c6">,</span>
</span></span><span style="display:flex;"><span>                ScrollPaneConstants<span style="color:#ff79c6">.</span><span style="color:#50fa7b">HORIZONTAL_SCROLLBAR_AS_NEEDED</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//Do the layout.
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        JSplitPane splitPane <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JSplitPane<span style="color:#ff79c6">(</span>JSplitPane<span style="color:#ff79c6">.</span><span style="color:#50fa7b">VERTICAL_SPLIT</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        add<span style="color:#ff79c6">(</span>splitPane<span style="color:#ff79c6">,</span> BorderLayout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">CENTER</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        JPanel topHalf <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JPanel<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        topHalf<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setLayout</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> BoxLayout<span style="color:#ff79c6">(</span>topHalf<span style="color:#ff79c6">,</span> BoxLayout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">LINE_AXIS</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        JPanel listContainer <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JPanel<span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> GridLayout<span style="color:#ff79c6">(</span>1<span style="color:#ff79c6">,</span>1<span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        listContainer<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setBorder</span><span style="color:#ff79c6">(</span>BorderFactory<span style="color:#ff79c6">.</span><span style="color:#50fa7b">createTitledBorder</span><span style="color:#ff79c6">(</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f1fa8c">&#34;List&#34;</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        listContainer<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>listPane<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        topHalf<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setBorder</span><span style="color:#ff79c6">(</span>BorderFactory<span style="color:#ff79c6">.</span><span style="color:#50fa7b">createEmptyBorder</span><span style="color:#ff79c6">(</span>5<span style="color:#ff79c6">,</span>5<span style="color:#ff79c6">,</span>0<span style="color:#ff79c6">,</span>5<span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        topHalf<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>listContainer<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//topHalf.add(tableContainer);
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span>        topHalf<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setMinimumSize</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> Dimension<span style="color:#ff79c6">(</span>100<span style="color:#ff79c6">,</span> 50<span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        topHalf<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setPreferredSize</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> Dimension<span style="color:#ff79c6">(</span>100<span style="color:#ff79c6">,</span> 110<span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        splitPane<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>topHalf<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        JPanel bottomHalf <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JPanel<span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> BorderLayout<span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>        bottomHalf<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>controlPane<span style="color:#ff79c6">,</span> BorderLayout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">PAGE_START</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        bottomHalf<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>outputPane<span style="color:#ff79c6">,</span> BorderLayout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">CENTER</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//XXX: next line needed if bottomHalf is a scroll pane:
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#6272a4">//bottomHalf.setMinimumSize(new Dimension(400, 50));
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        bottomHalf<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setPreferredSize</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> Dimension<span style="color:#ff79c6">(</span>450<span style="color:#ff79c6">,</span> 135<span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        splitPane<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>bottomHalf<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">/**
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">     * Create the GUI and show it.  For thread safety,
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">     * this method should be invoked from the
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">     * event-dispatching thread.
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">createAndShowGUI</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//Create and set up the window.
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        JFrame frame <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JFrame<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;ListSelectionDemo&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        frame<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setDefaultCloseOperation</span><span style="color:#ff79c6">(</span>JFrame<span style="color:#ff79c6">.</span><span style="color:#50fa7b">EXIT_ON_CLOSE</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//Create and set up the content pane.
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        ListSelectionDemo demo <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> ListSelectionDemo<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        demo<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setOpaque</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">true</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        frame<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setContentPane</span><span style="color:#ff79c6">(</span>demo<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//Display the window.
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        frame<span style="color:#ff79c6">.</span><span style="color:#50fa7b">pack</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        frame<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setVisible</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">true</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">main</span><span style="color:#ff79c6">(</span>String<span style="color:#ff79c6">[]</span> args<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//Schedule a job for the event-dispatching thread:
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#6272a4">//creating and showing this application&#39;s GUI.
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        javax<span style="color:#ff79c6">.</span><span style="color:#50fa7b">swing</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">SwingUtilities</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">invokeLater</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> Runnable<span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">run</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                createAndShowGUI<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">});</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">SharedListSelectionHandler</span> <span style="color:#8be9fd;font-style:italic">implements</span> ListSelectionListener <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">valueChanged</span><span style="color:#ff79c6">(</span>ListSelectionEvent e<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            ListSelectionModel lsm <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">(</span>ListSelectionModel<span style="color:#ff79c6">)</span>e<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getSource</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#6272a4">//System.out.printf(&#34;LeadSelectionIndex is %s%n&#34;,lsm.getLeadSelectionIndex());
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>            output<span style="color:#ff79c6">.</span><span style="color:#50fa7b">append</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;LeadSelectionIndex is &#34;</span> <span style="color:#ff79c6">+</span> lsm<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getLeadSelectionIndex</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;\n&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd">int</span> firstIndex <span style="color:#ff79c6">=</span> e<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getFirstIndex</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd">int</span> lastIndex <span style="color:#ff79c6">=</span> e<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getLastIndex</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd">boolean</span> isAdjusting <span style="color:#ff79c6">=</span> e<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getValueIsAdjusting</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>            output<span style="color:#ff79c6">.</span><span style="color:#50fa7b">append</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Event for indexes &#34;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">+</span> firstIndex <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34; - &#34;</span> <span style="color:#ff79c6">+</span> lastIndex
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;; isAdjusting is &#34;</span> <span style="color:#ff79c6">+</span> isAdjusting
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;; selected indexes:&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>lsm<span style="color:#ff79c6">.</span><span style="color:#50fa7b">isSelectionEmpty</span><span style="color:#ff79c6">())</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                output<span style="color:#ff79c6">.</span><span style="color:#50fa7b">append</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34; &lt;none&gt;&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span> <span style="color:#ff79c6">else</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">// Find out which indexes are selected.
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                <span style="color:#8be9fd">int</span> minIndex <span style="color:#ff79c6">=</span> lsm<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getMinSelectionIndex</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8be9fd">int</span> maxIndex <span style="color:#ff79c6">=</span> lsm<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getMaxSelectionIndex</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> minIndex<span style="color:#ff79c6">;</span> i <span style="color:#ff79c6">&lt;=</span> maxIndex<span style="color:#ff79c6">;</span> i<span style="color:#ff79c6">++)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>lsm<span style="color:#ff79c6">.</span><span style="color:#50fa7b">isSelectedIndex</span><span style="color:#ff79c6">(</span>i<span style="color:#ff79c6">))</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                        output<span style="color:#ff79c6">.</span><span style="color:#50fa7b">append</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34; &#34;</span> <span style="color:#ff79c6">+</span> i<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>            output<span style="color:#ff79c6">.</span><span style="color:#50fa7b">append</span><span style="color:#ff79c6">(</span>newline<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>            output<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setCaretPosition</span><span style="color:#ff79c6">(</span>output<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getDocument</span><span style="color:#ff79c6">().</span><span style="color:#50fa7b">getLength</span><span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><img src="/imgs/image-20210823135325598.png" alt="image-20210823135325598" style="zoom:50%;" />
<p><strong>表格Demo.java</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">import</span> javax.swing.*<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.awt.*<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.awt.event.WindowAdapter<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.awt.event.WindowEvent<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">表格Demo</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#50fa7b">表格Demo</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        JFrame f <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JFrame<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        Object<span style="color:#ff79c6">[][]</span> playerInfo <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">// 创建表格中的数据
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                <span style="color:#ff79c6">{</span> <span style="color:#f1fa8c">&#34;王鹏&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>91<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>100<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>191<span style="color:#ff79c6">),</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">new</span> Boolean<span style="color:#ff79c6">(</span><span style="color:#ff79c6">true</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">{</span> <span style="color:#f1fa8c">&#34;朱学莲&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>82<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>69<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>151<span style="color:#ff79c6">),</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">new</span> Boolean<span style="color:#ff79c6">(</span><span style="color:#ff79c6">true</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">{</span> <span style="color:#f1fa8c">&#34;梅婷&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>47<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>57<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>104<span style="color:#ff79c6">),</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">new</span> Boolean<span style="color:#ff79c6">(</span><span style="color:#ff79c6">false</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">{</span> <span style="color:#f1fa8c">&#34;赵龙&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>61<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>57<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>118<span style="color:#ff79c6">),</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">new</span> Boolean<span style="color:#ff79c6">(</span><span style="color:#ff79c6">false</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">{</span> <span style="color:#f1fa8c">&#34;李兵&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>90<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>87<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>177<span style="color:#ff79c6">),</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">new</span> Boolean<span style="color:#ff79c6">(</span><span style="color:#ff79c6">true</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">{</span> <span style="color:#f1fa8c">&#34;李兵&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>90<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>87<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>177<span style="color:#ff79c6">),</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">new</span> Boolean<span style="color:#ff79c6">(</span><span style="color:#ff79c6">true</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">{</span> <span style="color:#f1fa8c">&#34;李兵&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>90<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>87<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>177<span style="color:#ff79c6">),</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">new</span> Boolean<span style="color:#ff79c6">(</span><span style="color:#ff79c6">true</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">{</span> <span style="color:#f1fa8c">&#34;李兵&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>90<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>87<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>177<span style="color:#ff79c6">),</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">new</span> Boolean<span style="color:#ff79c6">(</span><span style="color:#ff79c6">true</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">{</span> <span style="color:#f1fa8c">&#34;李兵&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>90<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>87<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>177<span style="color:#ff79c6">),</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">new</span> Boolean<span style="color:#ff79c6">(</span><span style="color:#ff79c6">true</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">{</span> <span style="color:#f1fa8c">&#34;李兵&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>90<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>87<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>177<span style="color:#ff79c6">),</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">new</span> Boolean<span style="color:#ff79c6">(</span><span style="color:#ff79c6">true</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">{</span> <span style="color:#f1fa8c">&#34;李兵&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>90<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>87<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>177<span style="color:#ff79c6">),</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">new</span> Boolean<span style="color:#ff79c6">(</span><span style="color:#ff79c6">true</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">},</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">{</span> <span style="color:#f1fa8c">&#34;李兵&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>90<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>87<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">new</span> Integer<span style="color:#ff79c6">(</span>177<span style="color:#ff79c6">),</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">new</span> Boolean<span style="color:#ff79c6">(</span><span style="color:#ff79c6">true</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">}};</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 创建表格中的横标题
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        String<span style="color:#ff79c6">[]</span> Names <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">{</span> <span style="color:#f1fa8c">&#34;姓名&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;语文&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;数学&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;总分&#34;</span><span style="color:#ff79c6">,</span> <span style="color:#f1fa8c">&#34;及格&#34;</span> <span style="color:#ff79c6">};</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 以Names和playerInfo为参数，创建一个表格
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        JTable table <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JTable<span style="color:#ff79c6">(</span>playerInfo<span style="color:#ff79c6">,</span> Names<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 设置此表视图的首选大小
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        table<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setPreferredScrollableViewportSize</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> Dimension<span style="color:#ff79c6">(</span>550<span style="color:#ff79c6">,</span> 100<span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 将表格加入到滚动条组件中
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        JScrollPane scrollPane <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JScrollPane<span style="color:#ff79c6">(</span>table<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        f<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getContentPane</span><span style="color:#ff79c6">().</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>scrollPane<span style="color:#ff79c6">,</span> BorderLayout<span style="color:#ff79c6">.</span><span style="color:#50fa7b">CENTER</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 再将滚动条组件添加到中间容器中
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        f<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setTitle</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;表格测试窗口&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        f<span style="color:#ff79c6">.</span><span style="color:#50fa7b">pack</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        f<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setVisible</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">true</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        f<span style="color:#ff79c6">.</span><span style="color:#50fa7b">addWindowListener</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> WindowAdapter<span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            @Override
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">windowClosing</span><span style="color:#ff79c6">(</span>WindowEvent e<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                System<span style="color:#ff79c6">.</span><span style="color:#50fa7b">exit</span><span style="color:#ff79c6">(</span>0<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">});</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">main</span><span style="color:#ff79c6">(</span>String<span style="color:#ff79c6">[]</span> args<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        表格Demo t <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> 表格Demo<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><img src="/imgs/image-20210823135655106.png" alt="image-20210823135655106" style="zoom:50%;" />
<h2 id="开发实践">开发实践</h2>
<h3 id="解决问题">解决问题</h3>
<p>​		在实战中，很多站点，尤其是java站点，目录结构并非我们常见的层级目录，而是映射出来的，导致我们手中的字典经常不太符合实际需求，这个工具的用途就是从burp的历史流量中筛选我们要的目标，然后提取其所有URI进行组合，并根据我们提供的字典去探测可能存在的文件。</p>
<h3 id="实现思路">实现思路</h3>
<p>1.使用burpsuit IHttpRequestResponse接口，获取历史记录</p>
<p>2.根据用户输入的目标Host（可以是完整域名也可以部分，因为代码中用的是host.contains(str)进行匹配）匹配到的历史记录提取URI、host、协议、端口</p>
<p>3.例如：“/aa/bb/cc/”的URI会被处理成如下形式后存储到列表中：</p>
<p>​			“/aa”、“/aa/bb”、“/aa/bb/cc”</p>
<p>4.用户提供字典，获取到字典列表</p>
<p>​	ps: 这个字典不能太大，20以内最佳，因为该工具的初衷是用来发现敏感文件，例如web.xml，而不是做目录爆破。</p>
<h3 id="核心代码">核心代码</h3>
<h4 id="burpburpextenderjava">burp/BurpExtender.java</h4>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">106
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">107
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">108
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">109
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">110
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">111
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">112
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">113
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">114
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">115
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">116
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">117
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">118
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">119
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">120
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">121
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">122
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">123
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">124
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">125
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">126
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">127
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">128
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">129
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">130
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">131
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">132
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">133
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">134
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">135
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">136
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">137
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">138
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">139
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">140
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">141
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">142
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">143
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">144
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">145
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">146
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">147
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">148
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">149
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">150
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">151
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">152
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">153
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">154
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">155
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">156
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">157
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">158
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">159
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.awt.*<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.util.*<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.util.List<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">BurpExtender</span> <span style="color:#8be9fd;font-style:italic">implements</span> IBurpExtender<span style="color:#ff79c6">,</span> ITab<span style="color:#ff79c6">,</span> IExtensionStateListener <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> FileScannerUI fileScannerUI<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> String targetHost<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">registerExtenderCallbacks</span><span style="color:#ff79c6">(</span>IBurpExtenderCallbacks callbacks<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span><span style="color:#ff79c6">.</span><span style="color:#50fa7b">callbacks</span> <span style="color:#ff79c6">=</span> callbacks<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">/*
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">            设置插件名称
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">         */</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setExtensionName</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;FileScanner&#34;</span><span style="color:#ff79c6">);</span> <span style="color:#6272a4">//这个是显示在插件中心的名字
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//创建GUI界面类registerExtensionStateListener
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        fileScannerUI <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> FileScannerUI<span style="color:#ff79c6">(</span>BurpExtender<span style="color:#ff79c6">.</span><span style="color:#50fa7b">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//注册ITAB接口
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">addSuiteTab</span><span style="color:#ff79c6">(</span>BurpExtender<span style="color:#ff79c6">.</span><span style="color:#50fa7b">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">registerExtensionStateListener</span><span style="color:#ff79c6">(</span>BurpExtender<span style="color:#ff79c6">.</span><span style="color:#50fa7b">this</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//加载后输出
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">printOutput</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Load Success...\nPowered By 安恒水滴实验室...\n&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> String <span style="color:#50fa7b">getTabCaption</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//返回标签页的名字
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#34;FileScanner&#34;</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> Component <span style="color:#50fa7b">getUiComponent</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//返回GUI界面主面板
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">return</span> fileScannerUI<span style="color:#ff79c6">.</span><span style="color:#50fa7b">$$$getRootComponent$$$</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">/*
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">        获取数据包并解析
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">        这里后面需要增加黑白名单功能，只获取要的目标host的路径、排除不要的目标
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">     */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">//String path;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd;font-style:italic">public</span> List<span style="color:#ff79c6">&lt;</span>List<span style="color:#ff79c6">&lt;</span>String<span style="color:#ff79c6">&gt;&gt;</span> <span style="color:#50fa7b">getDir</span><span style="color:#ff79c6">(</span>String target<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        targetHost <span style="color:#ff79c6">=</span> target<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>        IHttpRequestResponse<span style="color:#ff79c6">[]</span> httpRequestResponses <span style="color:#ff79c6">=</span> callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getProxyHistory</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        IExtensionHelpers helpers <span style="color:#ff79c6">=</span> callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getHelpers</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//创建一个List用来装所有path,这里不能用hashMap存host和path,因为host作为键的话会存在重复，对host的筛选应该放在解析数据包的时候
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        List<span style="color:#ff79c6">&lt;</span>String<span style="color:#ff79c6">&gt;</span> listPaths <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> ArrayList<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//创建一个List用来存放host
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        List<span style="color:#ff79c6">&lt;</span>String<span style="color:#ff79c6">&gt;</span> listStr <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> ArrayList<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 获取所有路径
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">(</span>IHttpRequestResponse httpRequestResponse <span style="color:#ff79c6">:</span> httpRequestResponses<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            IRequestInfo requestInfo <span style="color:#ff79c6">=</span> helpers<span style="color:#ff79c6">.</span><span style="color:#50fa7b">analyzeRequest</span><span style="color:#ff79c6">(</span>httpRequestResponse<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#6272a4">//请求头host
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>            String host <span style="color:#ff79c6">=</span> requestInfo<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getUrl</span><span style="color:#ff79c6">().</span><span style="color:#50fa7b">getHost</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">if</span><span style="color:#ff79c6">(</span>host<span style="color:#ff79c6">.</span><span style="color:#50fa7b">contains</span><span style="color:#ff79c6">(</span>targetHost<span style="color:#ff79c6">)){</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">//请求的URI
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                String fullPath <span style="color:#ff79c6">=</span> requestInfo<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getUrl</span><span style="color:#ff79c6">().</span><span style="color:#50fa7b">getPath</span><span style="color:#ff79c6">();</span>  <span style="color:#6272a4">// /web/html/1.html
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">//协议://host:端口
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                String str <span style="color:#ff79c6">=</span> requestInfo<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getUrl</span><span style="color:#ff79c6">().</span><span style="color:#50fa7b">getProtocol</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;://&#34;</span> <span style="color:#ff79c6">+</span>requestInfo<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getUrl</span><span style="color:#ff79c6">().</span><span style="color:#50fa7b">getHost</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;:&#34;</span> <span style="color:#ff79c6">+</span> requestInfo<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getUrl</span><span style="color:#ff79c6">().</span><span style="color:#50fa7b">getPort</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>                listStr<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>str<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">//提取所有路径/aa/bb/cc -&gt;  /aa/bb/cc 、/aa/bb 、 /aa
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                String<span style="color:#ff79c6">[]</span> paths <span style="color:#ff79c6">=</span> fullPath<span style="color:#ff79c6">.</span><span style="color:#50fa7b">split</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;/&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8be9fd">int</span> len <span style="color:#ff79c6">=</span> paths<span style="color:#ff79c6">.</span><span style="color:#50fa7b">length</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>checkPath<span style="color:#ff79c6">(</span>fullPath<span style="color:#ff79c6">))</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> 1<span style="color:#ff79c6">;</span> i <span style="color:#ff79c6">&lt;</span> len <span style="color:#ff79c6">-</span> 1<span style="color:#ff79c6">;</span> i<span style="color:#ff79c6">++)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                        StringBuilder stringBuilder <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> StringBuilder<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">int</span> j <span style="color:#ff79c6">=</span> 1<span style="color:#ff79c6">;</span> j <span style="color:#ff79c6">&lt;=</span> i<span style="color:#ff79c6">;</span> j<span style="color:#ff79c6">++)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                            stringBuilder<span style="color:#ff79c6">.</span><span style="color:#50fa7b">append</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;/&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>                            stringBuilder<span style="color:#ff79c6">.</span><span style="color:#50fa7b">append</span><span style="color:#ff79c6">(</span>paths<span style="color:#ff79c6">[</span>j<span style="color:#ff79c6">]);</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>                        stringBuilder<span style="color:#ff79c6">.</span><span style="color:#50fa7b">append</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;/&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>                        String resultPath <span style="color:#ff79c6">=</span> stringBuilder<span style="color:#ff79c6">.</span><span style="color:#50fa7b">toString</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>checkPath<span style="color:#ff79c6">(</span>resultPath<span style="color:#ff79c6">))</span> <span style="color:#ff79c6">{</span> <span style="color:#6272a4">//检查路径是否符合要求
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                            listPaths<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>resultPath<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span><span style="color:#ff79c6">else</span><span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">continue</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">/*
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">            对path和host去重
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">         */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        HashSet set1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> HashSet<span style="color:#ff79c6">(</span>listPaths<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 清空list集合
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        listPaths<span style="color:#ff79c6">.</span><span style="color:#50fa7b">clear</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 将去重后的元素重新添加到list中
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        listPaths<span style="color:#ff79c6">.</span><span style="color:#50fa7b">addAll</span><span style="color:#ff79c6">(</span>set1<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        HashSet set2 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> HashSet<span style="color:#ff79c6">(</span>listStr<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 清空list集合
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        listStr<span style="color:#ff79c6">.</span><span style="color:#50fa7b">clear</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 将去重后的元素重新添加到list中
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        listStr<span style="color:#ff79c6">.</span><span style="color:#50fa7b">addAll</span><span style="color:#ff79c6">(</span>set2<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//将路径、没有URI的URL两个列表押入returnList列表中
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        List<span style="color:#ff79c6">&lt;</span>List<span style="color:#ff79c6">&lt;</span>String<span style="color:#ff79c6">&gt;&gt;</span> returnList <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> ArrayList<span style="color:#ff79c6">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>        returnList<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>listPaths<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        returnList<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>listStr<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> returnList<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">extensionUnloaded</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        callbacks<span style="color:#ff79c6">.</span><span style="color:#50fa7b">printOutput</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;再见...&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">/*
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">        路径检查
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd">boolean</span> <span style="color:#50fa7b">checkPath</span><span style="color:#ff79c6">(</span>String path<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>path<span style="color:#ff79c6">.</span><span style="color:#50fa7b">length</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">&gt;</span> 256<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>path<span style="color:#ff79c6">.</span><span style="color:#50fa7b">equals</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;/&#34;</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">||</span> path<span style="color:#ff79c6">.</span><span style="color:#50fa7b">equals</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;//&#34;</span><span style="color:#ff79c6">))</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">true</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="burpfilescanneruijava">/burp/FileScannerUI.java</h4>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">106
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">107
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">108
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">109
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">110
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">111
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">112
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">113
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">114
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">115
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">116
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">117
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">118
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">119
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">120
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">121
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">122
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">123
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">124
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">125
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">126
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">127
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">128
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">129
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">130
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">131
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">132
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">133
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">134
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">135
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">136
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">137
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">138
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">139
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">140
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">141
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">142
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">143
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">144
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">145
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">146
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">147
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">148
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">149
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">150
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">151
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">152
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">153
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">154
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">155
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">156
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">157
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">158
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">159
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">160
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">161
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">162
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">163
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">164
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">165
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">166
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">167
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">168
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">169
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">170
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">171
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">172
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">173
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">174
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">175
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">176
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">177
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">178
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">179
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">180
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">181
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">182
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">183
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">184
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">185
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">186
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">187
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">188
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">189
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">190
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">191
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">192
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">193
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">194
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">195
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">196
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">197
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">198
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">199
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">200
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">201
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">202
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">203
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">204
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">205
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">206
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">207
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">208
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">209
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">210
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">211
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">212
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">213
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">214
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">215
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">216
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">217
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">218
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">219
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">220
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">221
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">222
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">223
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">224
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">225
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">226
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">227
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">228
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">229
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">230
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">231
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">232
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">233
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">234
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">235
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">236
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">237
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">238
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">239
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">240
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">241
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">242
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">243
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">244
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">245
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">246
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">247
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">248
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">249
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">250
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">251
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">252
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">253
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">254
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">255
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> burp<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> com.intellij.uiDesigner.core.GridConstraints<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> com.intellij.uiDesigner.core.GridLayoutManager<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> javax.swing.*<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.awt.*<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.awt.event.ActionEvent<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.awt.event.ActionListener<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.io.*<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.util.List<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.util.concurrent.ExecutorService<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> utils.FixedThreadPool<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> utils.ReadFileTool<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> utils.HttpURLConnectionHelper<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">FileScannerUI</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> JPanel rootPanel<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> JButton jButton1<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> JButton jButton2<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> JLabel jLabel1<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> JLabel jLabel2<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> JLabel jLabel3<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> JTextField textField1<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> JTextArea textArea1<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> JScrollPane jscp1<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> JScrollPane jscp2<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> JTextArea textArea2<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> JScrollPane jscp4<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> JButton jButton0<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> JLabel jLabel4<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> JTextField textField0<span style="color:#ff79c6">;</span> <span style="color:#6272a4">//接收目标host
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> List<span style="color:#ff79c6">&lt;</span>List<span style="color:#ff79c6">&lt;</span>String<span style="color:#ff79c6">&gt;&gt;</span> msg<span style="color:#ff79c6">;</span>  <span style="color:#6272a4">//用来存放获取到的path和host两个列表
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd;font-style:italic">private</span> List<span style="color:#ff79c6">&lt;</span>String<span style="color:#ff79c6">&gt;</span> paths<span style="color:#ff79c6">;</span>  <span style="color:#6272a4">// 用来接收path列表
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd;font-style:italic">private</span> List<span style="color:#ff79c6">&lt;</span>String<span style="color:#ff79c6">&gt;</span> str<span style="color:#ff79c6">;</span> <span style="color:#6272a4">//用来接收不带路径的url列表
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd;font-style:italic">private</span> List<span style="color:#ff79c6">&lt;</span>String<span style="color:#ff79c6">&gt;</span> dictList<span style="color:#ff79c6">;</span> <span style="color:#6272a4">//用来存放字典转换后的列表
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">//创建一个文件选择器对象
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd;font-style:italic">private</span> JFileChooser jFileChooser <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JFileChooser<span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> File<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;.&#34;</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    JMenuItem x <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JMenuItem<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;Check for Struts RCE&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#50fa7b">FileScannerUI</span><span style="color:#ff79c6">(</span>BurpExtender burpExtender<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">/*
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">            选择文件的按钮事件
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">         */</span>
</span></span><span style="display:flex;"><span>        jButton1<span style="color:#ff79c6">.</span><span style="color:#50fa7b">addActionListener</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> ActionListener<span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            @Override
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">actionPerformed</span><span style="color:#ff79c6">(</span>ActionEvent e<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">//将文件选择器对象绑定在&#34;选择文件&#34;的按钮上
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                <span style="color:#8be9fd">int</span> status <span style="color:#ff79c6">=</span> jFileChooser<span style="color:#ff79c6">.</span><span style="color:#50fa7b">showOpenDialog</span><span style="color:#ff79c6">(</span>jButton1<span style="color:#ff79c6">);</span><span style="color:#6272a4">//showOpenDialog()是打开/导入
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">//判断是否选择了文件，如果选择了文件则去获取绝对路径
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                <span style="color:#ff79c6">if</span> <span style="color:#ff79c6">(</span>status <span style="color:#ff79c6">==</span> JFileChooser<span style="color:#ff79c6">.</span><span style="color:#50fa7b">FILES_ONLY</span><span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                    File fo <span style="color:#ff79c6">=</span> jFileChooser<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getSelectedFile</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>                    String absolutePath <span style="color:#ff79c6">=</span> fo<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getAbsolutePath</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#6272a4">//将文件路径输出在文本框中
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                    textField1<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setText</span><span style="color:#ff79c6">(</span>absolutePath<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    <span style="color:#6272a4">/*
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">                        获取到文件路径后，将文件的内容按行读取放进列表中
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">                     */</span>
</span></span><span style="display:flex;"><span>                    ReadFileTool readFileTool <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> ReadFileTool<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">try</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                        dictList <span style="color:#ff79c6">=</span> readFileTool<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getList</span><span style="color:#ff79c6">(</span>absolutePath<span style="color:#ff79c6">);</span> <span style="color:#6272a4">//调用ReadFileTool类的getList方法，获取到字典列表
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                    <span style="color:#ff79c6">}</span> <span style="color:#ff79c6">catch</span> <span style="color:#ff79c6">(</span>FileNotFoundException fileNotFoundException<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                        fileNotFoundException<span style="color:#ff79c6">.</span><span style="color:#50fa7b">printStackTrace</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">});</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        jButton0<span style="color:#ff79c6">.</span><span style="color:#50fa7b">addActionListener</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> ActionListener<span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            @Override
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">actionPerformed</span><span style="color:#ff79c6">(</span>ActionEvent e<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">/*
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">                   HttpURLConnectionHelper实例化的代码必须写在这里，不然后面codeAndLength的调用内容是空的。
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">                  */</span>
</span></span><span style="display:flex;"><span>                HttpURLConnectionHelper httpURLConnectionHelper <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> HttpURLConnectionHelper<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>                String targetHost <span style="color:#ff79c6">=</span> textField0<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getText</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>                msg <span style="color:#ff79c6">=</span> burpExtender<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getDir</span><span style="color:#ff79c6">(</span>targetHost<span style="color:#ff79c6">);</span> <span style="color:#6272a4">//getDir()的结果中有URI集合、不带URI的URL集合
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                paths <span style="color:#ff79c6">=</span> msg<span style="color:#ff79c6">.</span><span style="color:#50fa7b">get</span><span style="color:#ff79c6">(</span>0<span style="color:#ff79c6">);</span> <span style="color:#6272a4">//所有URI的集合
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                str <span style="color:#ff79c6">=</span> msg<span style="color:#ff79c6">.</span><span style="color:#50fa7b">get</span><span style="color:#ff79c6">(</span>1<span style="color:#ff79c6">);</span>  <span style="color:#6272a4">//不带URI的URL集合
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">//先清空文本域
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                textArea1<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setText</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>                textArea2<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setText</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">//将所有URI输出到textArea1
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                <span style="color:#ff79c6">for</span><span style="color:#ff79c6">(</span><span style="color:#8be9fd">int</span> i<span style="color:#ff79c6">=</span>0<span style="color:#ff79c6">;</span> i<span style="color:#ff79c6">&lt;</span>paths<span style="color:#ff79c6">.</span><span style="color:#50fa7b">size</span><span style="color:#ff79c6">();</span> i<span style="color:#ff79c6">++){</span>
</span></span><span style="display:flex;"><span>                    textArea1<span style="color:#ff79c6">.</span><span style="color:#50fa7b">append</span><span style="color:#ff79c6">(</span>paths<span style="color:#ff79c6">.</span><span style="color:#50fa7b">get</span><span style="color:#ff79c6">(</span>i<span style="color:#ff79c6">)+</span><span style="color:#f1fa8c">&#34;\n&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">/*
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">                    创建后面用来发包的线程池
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">                 */</span>
</span></span><span style="display:flex;"><span>                FixedThreadPool fixedThreadPool <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> FixedThreadPool<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>                ExecutorService threadPool <span style="color:#ff79c6">=</span> fixedThreadPool<span style="color:#ff79c6">.</span><span style="color:#50fa7b">fixedThreadPool</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">/*
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">                    循环出每个URL
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">                 */</span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">//每个不带URI的URL
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> 0<span style="color:#ff79c6">;</span> i <span style="color:#ff79c6">&lt;</span> str<span style="color:#ff79c6">.</span><span style="color:#50fa7b">size</span><span style="color:#ff79c6">();</span> i<span style="color:#ff79c6">++)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#6272a4">//每个URI
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                    <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">int</span> j <span style="color:#ff79c6">=</span> 0<span style="color:#ff79c6">;</span> j <span style="color:#ff79c6">&lt;</span> paths<span style="color:#ff79c6">.</span><span style="color:#50fa7b">size</span><span style="color:#ff79c6">();</span> j<span style="color:#ff79c6">++)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#6272a4">//字典的每一行
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                        <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">(</span><span style="color:#8be9fd">int</span> t <span style="color:#ff79c6">=</span> 0<span style="color:#ff79c6">;</span> t <span style="color:#ff79c6">&lt;</span> dictList<span style="color:#ff79c6">.</span><span style="color:#50fa7b">size</span><span style="color:#ff79c6">();</span> t<span style="color:#ff79c6">++)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                            String url <span style="color:#ff79c6">=</span> str<span style="color:#ff79c6">.</span><span style="color:#50fa7b">get</span><span style="color:#ff79c6">(</span>i<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">+</span> paths<span style="color:#ff79c6">.</span><span style="color:#50fa7b">get</span><span style="color:#ff79c6">(</span>j<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">+</span> dictList<span style="color:#ff79c6">.</span><span style="color:#50fa7b">get</span><span style="color:#ff79c6">(</span>t<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                            <span style="color:#6272a4">/*
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">                                    多线程进行发包和实时更新文本域内容
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">                             */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                            threadPool<span style="color:#ff79c6">.</span><span style="color:#50fa7b">execute</span><span style="color:#ff79c6">(()</span> <span style="color:#ff79c6">-&gt;</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                                httpURLConnectionHelper<span style="color:#ff79c6">.</span><span style="color:#50fa7b">doGet</span><span style="color:#ff79c6">(</span>url<span style="color:#ff79c6">,</span>textArea2<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>                               <span style="color:#6272a4">// textArea2.append(url + &#34;   状态码：&#34; + codeAndLength.get(0) + &#34;  响应长度：&#34; + codeAndLength.get(1) + &#34;\n&#34;+ codeAndLength.get(2) + &#34;\n&#34;);//+ &#34;   状态码：&#34; + codeAndLength.get(0) + &#34;  响应长度：&#34; + codeAndLength.get(1) + &#34;\n&#34;+ codeAndLength.get(2) + &#34;\n&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                            <span style="color:#ff79c6">});</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">});</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">//按钮：保存路径
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        jButton2<span style="color:#ff79c6">.</span><span style="color:#50fa7b">addActionListener</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> ActionListener<span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            @Override
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">actionPerformed</span><span style="color:#ff79c6">(</span>ActionEvent e<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">//将路径选择器对象绑定在&#34;导出路径&#34;的按钮上
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                <span style="color:#8be9fd">int</span> status <span style="color:#ff79c6">=</span> jFileChooser<span style="color:#ff79c6">.</span><span style="color:#50fa7b">showSaveDialog</span><span style="color:#ff79c6">(</span>jButton2<span style="color:#ff79c6">);</span> <span style="color:#6272a4">//showSaveDialog()是保存
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>
</span></span><span style="display:flex;"><span>                File f <span style="color:#ff79c6">=</span> jFileChooser<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getSelectedFile</span><span style="color:#ff79c6">();</span><span style="color:#6272a4">// f为选择到的目录
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>                <span style="color:#ff79c6">try</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                    bufferedOutputStreamMethod<span style="color:#ff79c6">(</span>f<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getAbsolutePath</span><span style="color:#ff79c6">(),</span> textArea1<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getText</span><span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">}</span> <span style="color:#ff79c6">catch</span> <span style="color:#ff79c6">(</span>IOException ioException<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>                    ioException<span style="color:#ff79c6">.</span><span style="color:#50fa7b">printStackTrace</span><span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">});</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// 文件导出函数
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">bufferedOutputStreamMethod</span><span style="color:#ff79c6">(</span>String filepath<span style="color:#ff79c6">,</span> String content<span style="color:#ff79c6">)</span> <span style="color:#8be9fd;font-style:italic">throws</span> IOException <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">try</span> <span style="color:#ff79c6">(</span>BufferedOutputStream bufferedOutputStream <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> BufferedOutputStream<span style="color:#ff79c6">(</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">new</span> FileOutputStream<span style="color:#ff79c6">(</span>filepath<span style="color:#ff79c6">)))</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>            bufferedOutputStream<span style="color:#ff79c6">.</span><span style="color:#50fa7b">write</span><span style="color:#ff79c6">(</span>content<span style="color:#ff79c6">.</span><span style="color:#50fa7b">getBytes</span><span style="color:#ff79c6">());</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">createUIComponents</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// TODO: place custom component creation code here
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">// GUI initializer generated by IntelliJ IDEA GUI Designer
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">// &gt;&gt;&gt; IMPORTANT!! &lt;&lt;&lt;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">// DO NOT EDIT OR ADD ANY CODE HERE!
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>        $$$setupUI$$$<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">/**
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">     * Method generated by IntelliJ IDEA GUI Designer
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">     * &gt;&gt;&gt; IMPORTANT!! &lt;&lt;&lt;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">     * DO NOT edit this method OR call it in your code!
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">     *
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">     * @noinspection ALL
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">$$$setupUI$$$</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        rootPanel <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JPanel<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        rootPanel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setLayout</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> GridLayoutManager<span style="color:#ff79c6">(</span>9<span style="color:#ff79c6">,</span> 3<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> Insets<span style="color:#ff79c6">(</span>0<span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">),</span> <span style="color:#ff79c6">-</span>1<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">-</span>1<span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        jLabel1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JLabel<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        jLabel1<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setText</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;字 典 路 径：&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        rootPanel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>jLabel1<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> GridConstraints<span style="color:#ff79c6">(</span>1<span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">ANCHOR_CENTER</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">FILL_NONE</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_FIXED</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_FIXED</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        jButton1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JButton<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        jButton1<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setText</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;选择文件&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        rootPanel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>jButton1<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> GridConstraints<span style="color:#ff79c6">(</span>1<span style="color:#ff79c6">,</span> 2<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">ANCHOR_CENTER</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">FILL_HORIZONTAL</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_CAN_SHRINK</span> <span style="color:#ff79c6">|</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_CAN_GROW</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_FIXED</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        jLabel2 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JLabel<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        jLabel2<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setHorizontalAlignment</span><span style="color:#ff79c6">(</span>0<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        jLabel2<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setHorizontalTextPosition</span><span style="color:#ff79c6">(</span>0<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        jLabel2<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setText</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;存 在 路 径：&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        rootPanel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>jLabel2<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> GridConstraints<span style="color:#ff79c6">(</span>2<span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">ANCHOR_CENTER</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">FILL_NONE</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_FIXED</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_FIXED</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        jButton2 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JButton<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        jButton2<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setText</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;导出路径&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        rootPanel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>jButton2<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> GridConstraints<span style="color:#ff79c6">(</span>2<span style="color:#ff79c6">,</span> 2<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">ANCHOR_CENTER</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">FILL_HORIZONTAL</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_CAN_SHRINK</span> <span style="color:#ff79c6">|</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_CAN_GROW</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_FIXED</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        jLabel3 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JLabel<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        jLabel3<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setText</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;状态码200、302，ContenLength &gt; 0 的链接：&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        rootPanel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>jLabel3<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> GridConstraints<span style="color:#ff79c6">(</span>3<span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">ANCHOR_WEST</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">FILL_NONE</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_FIXED</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_FIXED</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        jscp1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JScrollPane<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        rootPanel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>jscp1<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> GridConstraints<span style="color:#ff79c6">(</span>1<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">ANCHOR_CENTER</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">FILL_BOTH</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_CAN_SHRINK</span> <span style="color:#ff79c6">|</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_WANT_GROW</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_CAN_SHRINK</span> <span style="color:#ff79c6">|</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_WANT_GROW</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        textField1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JTextField<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        jscp1<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setViewportView</span><span style="color:#ff79c6">(</span>textField1<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        jscp2 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JScrollPane<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        rootPanel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>jscp2<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> GridConstraints<span style="color:#ff79c6">(</span>2<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">ANCHOR_CENTER</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">FILL_BOTH</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_CAN_SHRINK</span> <span style="color:#ff79c6">|</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_WANT_GROW</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_CAN_SHRINK</span> <span style="color:#ff79c6">|</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_WANT_GROW</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        textArea1 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JTextArea<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        jscp2<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setViewportView</span><span style="color:#ff79c6">(</span>textArea1<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        jscp4 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JScrollPane<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        rootPanel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>jscp4<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> GridConstraints<span style="color:#ff79c6">(</span>6<span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> 3<span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">ANCHOR_CENTER</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">FILL_BOTH</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_CAN_SHRINK</span> <span style="color:#ff79c6">|</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_WANT_GROW</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_CAN_SHRINK</span> <span style="color:#ff79c6">|</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_WANT_GROW</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        textArea2 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JTextArea<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        jscp4<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setViewportView</span><span style="color:#ff79c6">(</span>textArea2<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        jButton0 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JButton<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        jButton0<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setText</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;开 始&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        rootPanel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>jButton0<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> GridConstraints<span style="color:#ff79c6">(</span>0<span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">ANCHOR_CENTER</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">FILL_HORIZONTAL</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_CAN_SHRINK</span> <span style="color:#ff79c6">|</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_CAN_GROW</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_FIXED</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        jLabel4 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JLabel<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        jLabel4<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setText</span><span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;注：适合少量文件爆破，例如：爆破web.xml文件，建议爆破文件/目录不超过20条不然会卡很久...      目标Host：&#34;</span><span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>        rootPanel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>jLabel4<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> GridConstraints<span style="color:#ff79c6">(</span>0<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> 2<span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">ANCHOR_WEST</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">FILL_NONE</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_FIXED</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_FIXED</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        textField0 <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> JTextField<span style="color:#ff79c6">();</span>
</span></span><span style="display:flex;"><span>        textField0<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setMinimumSize</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> Dimension<span style="color:#ff79c6">(</span>100<span style="color:#ff79c6">,</span> 100<span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        textField0<span style="color:#ff79c6">.</span><span style="color:#50fa7b">setMaximumSize</span><span style="color:#ff79c6">(</span><span style="color:#ff79c6">new</span> Dimension<span style="color:#ff79c6">(</span>100<span style="color:#ff79c6">,</span> 100<span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>        rootPanel<span style="color:#ff79c6">.</span><span style="color:#50fa7b">add</span><span style="color:#ff79c6">(</span>textField0<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">new</span> GridConstraints<span style="color:#ff79c6">(</span>0<span style="color:#ff79c6">,</span> 2<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> 1<span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">ANCHOR_CENTER</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">FILL_BOTH</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_CAN_SHRINK</span> <span style="color:#ff79c6">|</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_WANT_GROW</span><span style="color:#ff79c6">,</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_CAN_SHRINK</span> <span style="color:#ff79c6">|</span> GridConstraints<span style="color:#ff79c6">.</span><span style="color:#50fa7b">SIZEPOLICY_WANT_GROW</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> <span style="color:#ff79c6">null</span><span style="color:#ff79c6">,</span> 0<span style="color:#ff79c6">,</span> <span style="color:#ff79c6">false</span><span style="color:#ff79c6">));</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">/**
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">     * @noinspection ALL
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> JComponent <span style="color:#50fa7b">$$$getRootComponent$$$</span><span style="color:#ff79c6">()</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> rootPanel<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="最后效果">最后效果</h3>
<p>PS：UI有点丑，但是不影响使用，建议把swing好好学一下，最简单的就是用IDeaJ的Swing GUI 进行UI设计,拖拖拽拽最后实现功能即可。</p>
<p><img src="/imgs/image-20210827144829492.png" alt="image-20210827144829492"></p>
<h2 id="总结">总结</h2>
<p>​		总的来说，burpsuit插件开发，需要先确定需求，然后可以结合IDeaJ的Swing GUI 功能，进行拖拽，将UI设计出来，最后再具体实现其中功能即可，如果是涉及到扫描、爆破，建议使用线程池进行操作，避免内存占用过高。由于前人写过的工具很多，想不明白的地方可以找前人写的工具，功能相似的插件借阅一下，找的到源码的就直接看，找不到源码的用jd-gui反编译一下就能看了，通常来说并不会有人会对插件代码做加密。</p>

      </article>
    </section>

    

    

    
  </div>
</div>


            <footer class="ui basic center aligned segment" style="background-color: transparent;">
              
              <p>© 2021 - 2022 rebootORZ Security</p>
              

              <p>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> with theme <a href="https://github.com/g1eny0ung/hugo-theme-dream" target="_blank">Dream</a>.</p>

              
            </footer>
          </div>
        </section>
        <section class="back">
          <div class="dream-max-width">
            <header class="ui basic very padded segment dream-header">
  
  <div class="ui small circular image">
    <img src="/me/gl.jpg" alt="avatar" />
  </div>
  

  <div class="content">
    <h1 class="ui medium header">rebootORZ Security , EXP Loading ...<span class="sub header">🦶走过的叫足迹 ，走不到叫憧憬。</span>
    </h1>

    <article class="ui horizontal list">
      
      <a class="item" href="/posts">
        <i class="archive icon" title="归档"></i>
      </a>
      
      <a class="item" href="/categories">
        <i class="th list icon" title="所有分类"></i>
      </a>
      <a class="item" href="/tags">
        <i class="tags icon" title="所有标签"></i>
      </a>
    </article>

    
    
    
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
    

    

    
    
    
          <div class="dream-tags">
          
          
          
            <a class="ui label" href="/tags/docker/" title="Docker">
              Docker
            </a>
          
          
          
            <a class="ui label" href="/tags/java/" title="java">
              java
            </a>
          
          
          
            <a class="ui label" href="/tags/jsp/" title="jsp">
              jsp
            </a>
          
          
          
            <a class="ui label" href="/tags/springboot/" title="SpringBoot">
              SpringBoot
            </a>
          
          
          
            <a class="ui label" href="/tags/webshell/" title="webshell">
              webshell
            </a>
          
          
          
            <a class="ui label" href="/tags/wifi/" title="WiFi">
              WiFi
            </a>
          
          
          
            <a class="ui label" href="/tags/%E7%BA%A2%E9%98%9F%E6%8A%80%E6%9C%AF/" title="红队技术">
              红队技术
            </a>
          
          
          
            <a class="ui label" href="/tags/%E8%93%9D%E7%89%99/" title="蓝牙">
              蓝牙
            </a>
          
          </div>
    

    
  </div>
</header>


<div class="ui relaxed grid dream-grid dream-back">
  
  
  

  <div class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
    <article class="ui segment">
      <div class="ui medium header">社交链接</div>
      <nav class="ui secondary menu dream-menu dream-socials">
  
  <a class="item" href="/index.xml">
    <i class="large rss square icon" title="RSS"></i>
  </a>
  

  

  

  

  

  

  

  
  <a class="item" href="https://github.com/https://github.com/rebootORZ/" target="_blank">
    <i class="large github icon" title="GitHub"></i>
  </a>
  

  

  

  
</nav>

    </article>
  </div>

  <div class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
    
    <article class="ui segment">
      <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。<br /><br />背景使用了 <a href="https://www.pexels.com/zh-cn/" target="_blank">Pexels</a> 上 <a href="https://www.pexels.com/zh-cn/@minan1398" target="_blank">Min An</a> 拍摄的<a href="https://www.pexels.com/zh-cn/photo/1454794/" target="_blank">图片</a>。
    </article>
    
  </div>

  
</div>

          </div>
        </section>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js" integrity="sha256-CgSoWC9w5wNmI1aN8dIMK+6DPelUEtvDr+Bc2m/0Nx8=" crossorigin="anonymous"></script>

    
    <div class="ui segment" id="dream-search">
  <div class="ui search">
    <div class="ui transparent input">
      <input class="prompt" type="text" placeholder="搜索" />
    </div>
    <div class="results"></div>
  </div>
</div>
<script>
  $(document).ready(function () {
    $.getJSON('https:\/\/rebootorz.github.io/index.json', function (data) {
      $('.ui.search').search({
        source: data,
        searchFields: ['title'],
        showNoResults: false,
      })
    })
  })
</script>
<script src="/js/search.js"></script>

    

    

    <script>
  window.background = "#fff"
  window.defaultDark =  null 
  window.backgroundDark =  null 
  window.backgroundImageDark = "/me/light_background.jpeg"
  window.darkNav =  true 
  window.maxTags =  null 
  window.hasTwitterEmbed =  null 
  window.fixedNav =  null 

  if (window.hasTwitterEmbed) {
    
    window.twttr = (function (d, s, id) {
      var js,
        fjs = d.getElementsByTagName(s)[0],
        t = window.twttr || {}
      if (d.getElementById(id)) return t
      js = d.createElement(s)
      js.id = id
      js.src = 'https://platform.twitter.com/widgets.js'
      fjs.parentNode.insertBefore(js, fjs)

      t._e = []
      t.ready = function (f) {
        t._e.push(f)
      }

      return t
    })(document, 'script', 'twitter-wjs')
  }
</script>
<script src="https://cdn.jsdelivr.net/npm/overlayscrollbars@1.13.1/js/jquery.overlayScrollbars.min.js" integrity="sha256-tBd38uWlvgfps3zHPrUb2ePBg+Z8EjMf0QloFONzpvU=" crossorigin="anonymous"></script>
<script src="/js/header.js"></script>
<script src="/js/main.js"></script>
<script src="/js/theme.js"></script>

    


<script src="https://cdn.jsdelivr.net/npm/luxon@1.26.0" integrity="sha256-4sbTzmCCW9LGrIh5OsN8V5Pfdad1F1MwhLAOyXKnsE0=" crossorigin="anonymous"></script>
<script>
  format()

  function format() {
    $('span[data-format="luxon"]').each(function () {
      var date = $(this).text()

      $(this).text(luxon.DateTime.fromISO(date, { locale: "zh" }).toFormat("yyyy年MM月dd日"))
    })
  }
</script>



<script src="/js/scrollToTop.js"></script>



<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.0.0-rc.1/dist/html2canvas.min.js" integrity="sha256-uacRffSSMP9qpvNWhVmYLykBv9YKMA1d/VSIN1AmfyQ=" crossorigin="anonymous"></script>
<script src="/js/post.js" defer></script>


    

    
  </body>
</html>
